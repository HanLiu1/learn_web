{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport \"antd/es/select/style\";\nimport _Select from \"antd/es/select\";\nvar _excluded = [\"optionItemRender\", \"mode\", \"onSearch\", \"onFocus\", \"onChange\", \"autoClearSearchValue\", \"searchOnFocus\", \"resetAfterSelect\", \"optionFilterProp\", \"optionLabelProp\", \"className\", \"disabled\", \"options\", \"fetchData\", \"resetData\", \"prefixCls\", \"onClear\", \"searchValue\", \"showSearch\"];\nimport React, { useContext, useImperativeHandle, useEffect, useRef, useState } from 'react';\nimport classNames from 'classnames';\nvar Option = _Select.Option,\n    OptGroup = _Select.OptGroup;\n\nvar SearchSelect = function SearchSelect(props, ref) {\n  var optionItemRender = props.optionItemRender,\n      mode = props.mode,\n      onSearch = props.onSearch,\n      _onFocus = props.onFocus,\n      _onChange = props.onChange,\n      autoClearSearchValue = props.autoClearSearchValue,\n      _props$searchOnFocus = props.searchOnFocus,\n      searchOnFocus = _props$searchOnFocus === void 0 ? false : _props$searchOnFocus,\n      _props$resetAfterSele = props.resetAfterSelect,\n      resetAfterSelect = _props$resetAfterSele === void 0 ? false : _props$resetAfterSele,\n      _props$optionFilterPr = props.optionFilterProp,\n      optionFilterProp = _props$optionFilterPr === void 0 ? 'label' : _props$optionFilterPr,\n      _props$optionLabelPro = props.optionLabelProp,\n      optionLabelProp = _props$optionLabelPro === void 0 ? 'label' : _props$optionLabelPro,\n      className = props.className,\n      disabled = props.disabled,\n      options = props.options,\n      fetchData = props.fetchData,\n      resetData = props.resetData,\n      customizePrefixCls = props.prefixCls,\n      _onClear = props.onClear,\n      propsSearchValue = props.searchValue,\n      showSearch = props.showSearch,\n      restProps = _objectWithoutProperties(props, _excluded);\n\n  var _useState = useState(propsSearchValue),\n      _useState2 = _slicedToArray(_useState, 2),\n      searchValue = _useState2[0],\n      setSearchValue = _useState2[1];\n\n  var selectRef = useRef();\n  useImperativeHandle(ref, function () {\n    return selectRef.current;\n  });\n  useEffect(function () {\n    if (restProps.autoFocus) {\n      var _selectRef$current;\n\n      selectRef === null || selectRef === void 0 ? void 0 : (_selectRef$current = selectRef.current) === null || _selectRef$current === void 0 ? void 0 : _selectRef$current.focus();\n    }\n  }, [restProps.autoFocus]);\n  useEffect(function () {\n    setSearchValue(propsSearchValue);\n  }, [propsSearchValue]);\n\n  var _useContext = useContext(_ConfigProvider.ConfigContext),\n      getPrefixCls = _useContext.getPrefixCls;\n\n  var prefixCls = getPrefixCls('pro-filed-search-select', customizePrefixCls); // 兼容 renderXXX API。\n\n  var classString = classNames(prefixCls, className, _defineProperty({}, \"\".concat(prefixCls, \"-disabled\"), disabled));\n\n  var getMergeValue = function getMergeValue(value, option) {\n    if (Array.isArray(value) && value.length > 0) {\n      // 多选情况且用户有选择\n      return value.map(function (item, index) {\n        var optionItem = option === null || option === void 0 ? void 0 : option[index];\n        var dataItem = (optionItem === null || optionItem === void 0 ? void 0 : optionItem['data-item']) || {};\n        return _objectSpread(_objectSpread({}, dataItem), item);\n      });\n    }\n\n    return [];\n  };\n\n  var renderOptions = function renderOptions(mapOptions) {\n    return mapOptions.map(function (item) {\n      var label = item.label,\n          value = item.value,\n          itemDisable = item.disabled,\n          itemClassName = item.className,\n          optionType = item.optionType;\n\n      if (optionType === 'optGroup') {\n        return /*#__PURE__*/React.createElement(OptGroup, {\n          key: item.key || item.value,\n          label: item.label\n        }, renderOptions((item === null || item === void 0 ? void 0 : item.options) || (item === null || item === void 0 ? void 0 : item.children) || []));\n      }\n\n      return /*#__PURE__*/React.createElement(Option, _extends({}, item, {\n        value: value,\n        key: value || (label === null || label === void 0 ? void 0 : label.toString()),\n        disabled: itemDisable,\n        \"data-item\": item,\n        className: \"\".concat(prefixCls, \"-option \").concat(itemClassName || ''),\n        label: item.label\n      }), (optionItemRender === null || optionItemRender === void 0 ? void 0 : optionItemRender(item)) || label);\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(_Select, _extends({\n    ref: selectRef,\n    className: classString,\n    allowClear: true,\n    disabled: disabled,\n    mode: mode,\n    showSearch: showSearch,\n    searchValue: searchValue,\n    optionFilterProp: optionFilterProp,\n    optionLabelProp: optionLabelProp,\n    onClear: function onClear() {\n      _onClear === null || _onClear === void 0 ? void 0 : _onClear();\n      fetchData('');\n\n      if (showSearch) {\n        setSearchValue('');\n      }\n    }\n  }, restProps, {\n    onSearch: showSearch ? function (value) {\n      fetchData(value);\n      onSearch === null || onSearch === void 0 ? void 0 : onSearch(value);\n      setSearchValue(value);\n    } : undefined,\n    onChange: function onChange(value, optionList) {\n      // 将搜索框置空 和 antd 行为保持一致\n      if (showSearch && autoClearSearchValue) {\n        fetchData('');\n        onSearch === null || onSearch === void 0 ? void 0 : onSearch('');\n        setSearchValue('');\n      }\n\n      for (var _len = arguments.length, rest = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n        rest[_key - 2] = arguments[_key];\n      }\n\n      if (!props.labelInValue) {\n        _onChange === null || _onChange === void 0 ? void 0 : _onChange.apply(void 0, [value, optionList].concat(rest));\n        return;\n      }\n\n      if (mode !== 'multiple') {\n        // 单选情况且用户选择了选项\n        var dataItem = optionList && optionList['data-item'] || {};\n        _onChange === null || _onChange === void 0 ? void 0 : _onChange.apply(void 0, [_objectSpread(_objectSpread({}, value), dataItem), optionList].concat(rest));\n        return;\n      } // 合并值\n\n\n      var mergeValue = getMergeValue(value, optionList);\n      _onChange === null || _onChange === void 0 ? void 0 : _onChange.apply(void 0, [mergeValue, optionList].concat(rest)); // 将搜索结果置空，重新搜索\n\n      if (resetAfterSelect) resetData();\n    },\n    onFocus: function onFocus(e) {\n      if (searchOnFocus) {\n        fetchData('');\n      }\n\n      _onFocus === null || _onFocus === void 0 ? void 0 : _onFocus(e);\n    }\n  }), renderOptions(options || []));\n};\n\nexport default /*#__PURE__*/React.forwardRef(SearchSelect);","map":{"version":3,"sources":["C:/web/my-app/node_modules/@ant-design/pro-field/es/components/Select/SearchSelect/index.js"],"names":["_extends","_objectSpread","_defineProperty","_ConfigProvider","_slicedToArray","_objectWithoutProperties","_Select","_excluded","React","useContext","useImperativeHandle","useEffect","useRef","useState","classNames","Option","OptGroup","SearchSelect","props","ref","optionItemRender","mode","onSearch","_onFocus","onFocus","_onChange","onChange","autoClearSearchValue","_props$searchOnFocus","searchOnFocus","_props$resetAfterSele","resetAfterSelect","_props$optionFilterPr","optionFilterProp","_props$optionLabelPro","optionLabelProp","className","disabled","options","fetchData","resetData","customizePrefixCls","prefixCls","_onClear","onClear","propsSearchValue","searchValue","showSearch","restProps","_useState","_useState2","setSearchValue","selectRef","current","autoFocus","_selectRef$current","focus","_useContext","ConfigContext","getPrefixCls","classString","concat","getMergeValue","value","option","Array","isArray","length","map","item","index","optionItem","dataItem","renderOptions","mapOptions","label","itemDisable","itemClassName","optionType","createElement","key","children","toString","allowClear","undefined","optionList","_len","arguments","rest","_key","labelInValue","apply","mergeValue","e","forwardRef"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport \"antd/es/select/style\";\nimport _Select from \"antd/es/select\";\nvar _excluded = [\"optionItemRender\", \"mode\", \"onSearch\", \"onFocus\", \"onChange\", \"autoClearSearchValue\", \"searchOnFocus\", \"resetAfterSelect\", \"optionFilterProp\", \"optionLabelProp\", \"className\", \"disabled\", \"options\", \"fetchData\", \"resetData\", \"prefixCls\", \"onClear\", \"searchValue\", \"showSearch\"];\nimport React, { useContext, useImperativeHandle, useEffect, useRef, useState } from 'react';\nimport classNames from 'classnames';\nvar Option = _Select.Option,\n    OptGroup = _Select.OptGroup;\n\nvar SearchSelect = function SearchSelect(props, ref) {\n  var optionItemRender = props.optionItemRender,\n      mode = props.mode,\n      onSearch = props.onSearch,\n      _onFocus = props.onFocus,\n      _onChange = props.onChange,\n      autoClearSearchValue = props.autoClearSearchValue,\n      _props$searchOnFocus = props.searchOnFocus,\n      searchOnFocus = _props$searchOnFocus === void 0 ? false : _props$searchOnFocus,\n      _props$resetAfterSele = props.resetAfterSelect,\n      resetAfterSelect = _props$resetAfterSele === void 0 ? false : _props$resetAfterSele,\n      _props$optionFilterPr = props.optionFilterProp,\n      optionFilterProp = _props$optionFilterPr === void 0 ? 'label' : _props$optionFilterPr,\n      _props$optionLabelPro = props.optionLabelProp,\n      optionLabelProp = _props$optionLabelPro === void 0 ? 'label' : _props$optionLabelPro,\n      className = props.className,\n      disabled = props.disabled,\n      options = props.options,\n      fetchData = props.fetchData,\n      resetData = props.resetData,\n      customizePrefixCls = props.prefixCls,\n      _onClear = props.onClear,\n      propsSearchValue = props.searchValue,\n      showSearch = props.showSearch,\n      restProps = _objectWithoutProperties(props, _excluded);\n\n  var _useState = useState(propsSearchValue),\n      _useState2 = _slicedToArray(_useState, 2),\n      searchValue = _useState2[0],\n      setSearchValue = _useState2[1];\n\n  var selectRef = useRef();\n  useImperativeHandle(ref, function () {\n    return selectRef.current;\n  });\n  useEffect(function () {\n    if (restProps.autoFocus) {\n      var _selectRef$current;\n\n      selectRef === null || selectRef === void 0 ? void 0 : (_selectRef$current = selectRef.current) === null || _selectRef$current === void 0 ? void 0 : _selectRef$current.focus();\n    }\n  }, [restProps.autoFocus]);\n  useEffect(function () {\n    setSearchValue(propsSearchValue);\n  }, [propsSearchValue]);\n\n  var _useContext = useContext(_ConfigProvider.ConfigContext),\n      getPrefixCls = _useContext.getPrefixCls;\n\n  var prefixCls = getPrefixCls('pro-filed-search-select', customizePrefixCls); // 兼容 renderXXX API。\n\n  var classString = classNames(prefixCls, className, _defineProperty({}, \"\".concat(prefixCls, \"-disabled\"), disabled));\n\n  var getMergeValue = function getMergeValue(value, option) {\n    if (Array.isArray(value) && value.length > 0) {\n      // 多选情况且用户有选择\n      return value.map(function (item, index) {\n        var optionItem = option === null || option === void 0 ? void 0 : option[index];\n        var dataItem = (optionItem === null || optionItem === void 0 ? void 0 : optionItem['data-item']) || {};\n        return _objectSpread(_objectSpread({}, dataItem), item);\n      });\n    }\n\n    return [];\n  };\n\n  var renderOptions = function renderOptions(mapOptions) {\n    return mapOptions.map(function (item) {\n      var label = item.label,\n          value = item.value,\n          itemDisable = item.disabled,\n          itemClassName = item.className,\n          optionType = item.optionType;\n\n      if (optionType === 'optGroup') {\n        return /*#__PURE__*/React.createElement(OptGroup, {\n          key: item.key || item.value,\n          label: item.label\n        }, renderOptions((item === null || item === void 0 ? void 0 : item.options) || (item === null || item === void 0 ? void 0 : item.children) || []));\n      }\n\n      return /*#__PURE__*/React.createElement(Option, _extends({}, item, {\n        value: value,\n        key: value || (label === null || label === void 0 ? void 0 : label.toString()),\n        disabled: itemDisable,\n        \"data-item\": item,\n        className: \"\".concat(prefixCls, \"-option \").concat(itemClassName || ''),\n        label: item.label\n      }), (optionItemRender === null || optionItemRender === void 0 ? void 0 : optionItemRender(item)) || label);\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(_Select, _extends({\n    ref: selectRef,\n    className: classString,\n    allowClear: true,\n    disabled: disabled,\n    mode: mode,\n    showSearch: showSearch,\n    searchValue: searchValue,\n    optionFilterProp: optionFilterProp,\n    optionLabelProp: optionLabelProp,\n    onClear: function onClear() {\n      _onClear === null || _onClear === void 0 ? void 0 : _onClear();\n      fetchData('');\n\n      if (showSearch) {\n        setSearchValue('');\n      }\n    }\n  }, restProps, {\n    onSearch: showSearch ? function (value) {\n      fetchData(value);\n      onSearch === null || onSearch === void 0 ? void 0 : onSearch(value);\n      setSearchValue(value);\n    } : undefined,\n    onChange: function onChange(value, optionList) {\n      // 将搜索框置空 和 antd 行为保持一致\n      if (showSearch && autoClearSearchValue) {\n        fetchData('');\n        onSearch === null || onSearch === void 0 ? void 0 : onSearch('');\n        setSearchValue('');\n      }\n\n      for (var _len = arguments.length, rest = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n        rest[_key - 2] = arguments[_key];\n      }\n\n      if (!props.labelInValue) {\n        _onChange === null || _onChange === void 0 ? void 0 : _onChange.apply(void 0, [value, optionList].concat(rest));\n        return;\n      }\n\n      if (mode !== 'multiple') {\n        // 单选情况且用户选择了选项\n        var dataItem = optionList && optionList['data-item'] || {};\n        _onChange === null || _onChange === void 0 ? void 0 : _onChange.apply(void 0, [_objectSpread(_objectSpread({}, value), dataItem), optionList].concat(rest));\n        return;\n      } // 合并值\n\n\n      var mergeValue = getMergeValue(value, optionList);\n      _onChange === null || _onChange === void 0 ? void 0 : _onChange.apply(void 0, [mergeValue, optionList].concat(rest)); // 将搜索结果置空，重新搜索\n\n      if (resetAfterSelect) resetData();\n    },\n    onFocus: function onFocus(e) {\n      if (searchOnFocus) {\n        fetchData('');\n      }\n\n      _onFocus === null || _onFocus === void 0 ? void 0 : _onFocus(e);\n    }\n  }), renderOptions(options || []));\n};\n\nexport default /*#__PURE__*/React.forwardRef(SearchSelect);"]},"metadata":{},"sourceType":"module"}