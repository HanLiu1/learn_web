{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nvar _excluded = [\"size\", \"collapse\", \"collapseLabel\", \"initialValues\", \"onValuesChange\", \"form\", \"formRef\", \"bordered\", \"ignoreRules\", \"footerRender\"];\nimport React, { useState, useImperativeHandle, useRef, useContext, useEffect, useMemo } from 'react';\nimport classNames from 'classnames';\nimport { FilterDropdown, FieldLabel } from '@ant-design/pro-utils';\nimport { useIntl } from '@ant-design/pro-provider';\nimport { FilterOutlined } from '@ant-design/icons';\nimport omit from 'omit.js';\nimport BaseForm from '../../BaseForm';\nimport './index.less';\n/**\n * 单行的查询表单，一般用于配合 table 或者 list使用 有时也会用于 card 的额外区域\n *\n * @param props\n */\n\nvar LightFilterContainer = function LightFilterContainer(props) {\n  var items = props.items,\n      prefixCls = props.prefixCls,\n      _props$size = props.size,\n      size = _props$size === void 0 ? 'middle' : _props$size,\n      collapse = props.collapse,\n      collapseLabel = props.collapseLabel,\n      onValuesChange = props.onValuesChange,\n      bordered = props.bordered,\n      _props$values = props.values,\n      values = _props$values === void 0 ? {} : _props$values,\n      footerRender = props.footerRender;\n  var intl = useIntl();\n  var lightFilterClassName = \"\".concat(prefixCls, \"-light-filter\");\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      open = _useState2[0],\n      setOpen = _useState2[1];\n\n  var _useState3 = useState(function () {\n    return _objectSpread({}, values);\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      moreValues = _useState4[0],\n      setMoreValues = _useState4[1];\n\n  useEffect(function () {\n    setMoreValues(_objectSpread({}, values));\n  }, [values]);\n\n  var _useMemo = useMemo(function () {\n    var collapseItemsArr = [];\n    var outsideItemsArr = [];\n    items.forEach(function (item) {\n      var _ref = item.props || {},\n          secondary = _ref.secondary;\n\n      if (secondary || collapse) {\n        collapseItemsArr.push(item);\n      } else {\n        outsideItemsArr.push(item);\n      }\n    });\n    return {\n      collapseItems: collapseItemsArr,\n      outsideItems: outsideItemsArr\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [props.items.length]),\n      collapseItems = _useMemo.collapseItems,\n      outsideItems = _useMemo.outsideItems;\n\n  var collapseLabelRender = function collapseLabelRender() {\n    if (collapseLabel) {\n      return collapseLabel;\n    }\n\n    if (collapse) {\n      return /*#__PURE__*/React.createElement(FilterOutlined, {\n        className: \"\".concat(lightFilterClassName, \"-collapse-icon\")\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(FieldLabel, {\n      size: size,\n      label: intl.getMessage('form.lightFilter.more', '更多筛选'),\n      expanded: open\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames(lightFilterClassName, \"\".concat(lightFilterClassName, \"-\").concat(size), _defineProperty({}, \"\".concat(lightFilterClassName, \"-effective\"), Object.keys(values).some(function (key) {\n      return values[key];\n    })))\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(lightFilterClassName, \"-container\")\n  }, outsideItems.map(function (child, index) {\n    var key = child.key;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(lightFilterClassName, \"-item\"),\n      key: key || index\n    }, /*#__PURE__*/React.cloneElement(child, {\n      // proFieldProps 会直接作为 ProField 的 props 传递过去\n      proFieldProps: {\n        light: true,\n        label: child.props.label,\n        bordered: bordered\n      },\n      bordered: bordered\n    }));\n  }), collapseItems.length ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(lightFilterClassName, \"-item\"),\n    key: \"more\"\n  }, /*#__PURE__*/React.createElement(FilterDropdown, {\n    padding: 24,\n    onVisibleChange: setOpen,\n    visible: open,\n    label: collapseLabelRender(),\n    footerRender: footerRender,\n    footer: {\n      onConfirm: function onConfirm() {\n        onValuesChange(_objectSpread({}, moreValues));\n        setOpen(false);\n      },\n      onClear: function onClear() {\n        var clearValues = {};\n        collapseItems.forEach(function (child) {\n          var name = child.props.name;\n          clearValues[name] = undefined;\n        });\n        onValuesChange(clearValues);\n      }\n    }\n  }, collapseItems.map(function (child) {\n    var key = child.key;\n    var _child$props = child.props,\n        name = _child$props.name,\n        fieldProps = _child$props.fieldProps;\n\n    var newFieldProps = _objectSpread(_objectSpread({}, fieldProps), {}, {\n      onChange: function onChange(e) {\n        setMoreValues(_objectSpread(_objectSpread({}, moreValues), {}, _defineProperty({}, name, (e === null || e === void 0 ? void 0 : e.target) ? e.target.value : e)));\n        return false;\n      }\n    });\n\n    if (moreValues.hasOwnProperty(name)) {\n      newFieldProps[child.props.valuePropName || 'value'] = moreValues[name];\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(lightFilterClassName, \"-line\"),\n      key: key\n    }, /*#__PURE__*/React.cloneElement(child, {\n      fieldProps: newFieldProps\n    }));\n  }))) : null));\n};\n\nfunction LightFilter(props) {\n  var size = props.size,\n      collapse = props.collapse,\n      collapseLabel = props.collapseLabel,\n      initialValues = props.initialValues,\n      _onValuesChange = props.onValuesChange,\n      userForm = props.form,\n      userFormRef = props.formRef,\n      bordered = props.bordered,\n      ignoreRules = props.ignoreRules,\n      footerRender = props.footerRender,\n      reset = _objectWithoutProperties(props, _excluded);\n\n  var _useContext = useContext(_ConfigProvider.ConfigContext),\n      getPrefixCls = _useContext.getPrefixCls;\n\n  var prefixCls = getPrefixCls('pro-form');\n\n  var _useState5 = useState(function () {\n    return _objectSpread({}, initialValues);\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      values = _useState6[0],\n      setValues = _useState6[1];\n\n  var formRef = useRef();\n  useImperativeHandle(userFormRef, function () {\n    return formRef.current;\n  });\n  return /*#__PURE__*/React.createElement(BaseForm, _extends({\n    size: size,\n    initialValues: initialValues,\n    form: userForm,\n    contentRender: function contentRender(items) {\n      return /*#__PURE__*/React.createElement(LightFilterContainer, {\n        prefixCls: prefixCls,\n        items: items.flatMap(function (item) {\n          if ((item === null || item === void 0 ? void 0 : item.type.displayName) === 'ProForm-Group') {\n            return item.props.children;\n          }\n\n          return item;\n        }),\n        size: size,\n        bordered: bordered,\n        collapse: collapse,\n        collapseLabel: collapseLabel,\n        values: values,\n        footerRender: footerRender,\n        onValuesChange: function onValuesChange(newValues) {\n          var _formRef$current, _formRef$current2;\n\n          var newAllValues = _objectSpread(_objectSpread({}, values), newValues);\n\n          setValues(newAllValues);\n          (_formRef$current = formRef.current) === null || _formRef$current === void 0 ? void 0 : _formRef$current.setFieldsValue(newAllValues);\n          (_formRef$current2 = formRef.current) === null || _formRef$current2 === void 0 ? void 0 : _formRef$current2.submit();\n\n          if (_onValuesChange) {\n            _onValuesChange(newValues, newAllValues);\n          }\n        }\n      });\n    },\n    formRef: formRef,\n    formItemProps: {\n      colon: false,\n      labelAlign: 'left'\n    },\n    fieldProps: {\n      style: {\n        width: undefined\n      }\n    }\n  }, omit(reset, ['labelWidth']), {\n    onValuesChange: function onValuesChange(_, allValues) {\n      var _formRef$current3;\n\n      setValues(allValues);\n\n      if (_onValuesChange) {\n        _onValuesChange(_, allValues);\n      }\n\n      (_formRef$current3 = formRef.current) === null || _formRef$current3 === void 0 ? void 0 : _formRef$current3.submit();\n    }\n  }));\n}\n\nexport default LightFilter;","map":{"version":3,"sources":["C:/web/my-app/node_modules/@ant-design/pro-form/es/layouts/LightFilter/index.js"],"names":["_extends","_ConfigProvider","_objectWithoutProperties","_defineProperty","_objectSpread","_slicedToArray","_excluded","React","useState","useImperativeHandle","useRef","useContext","useEffect","useMemo","classNames","FilterDropdown","FieldLabel","useIntl","FilterOutlined","omit","BaseForm","LightFilterContainer","props","items","prefixCls","_props$size","size","collapse","collapseLabel","onValuesChange","bordered","_props$values","values","footerRender","intl","lightFilterClassName","concat","_useState","_useState2","open","setOpen","_useState3","_useState4","moreValues","setMoreValues","_useMemo","collapseItemsArr","outsideItemsArr","forEach","item","_ref","secondary","push","collapseItems","outsideItems","length","collapseLabelRender","createElement","className","label","getMessage","expanded","Object","keys","some","key","map","child","index","cloneElement","proFieldProps","light","padding","onVisibleChange","visible","footer","onConfirm","onClear","clearValues","name","undefined","_child$props","fieldProps","newFieldProps","onChange","e","target","value","hasOwnProperty","valuePropName","LightFilter","initialValues","_onValuesChange","userForm","form","userFormRef","formRef","ignoreRules","reset","_useContext","ConfigContext","getPrefixCls","_useState5","_useState6","setValues","current","contentRender","flatMap","type","displayName","children","newValues","_formRef$current","_formRef$current2","newAllValues","setFieldsValue","submit","formItemProps","colon","labelAlign","style","width","_","allValues","_formRef$current3"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nvar _excluded = [\"size\", \"collapse\", \"collapseLabel\", \"initialValues\", \"onValuesChange\", \"form\", \"formRef\", \"bordered\", \"ignoreRules\", \"footerRender\"];\nimport React, { useState, useImperativeHandle, useRef, useContext, useEffect, useMemo } from 'react';\nimport classNames from 'classnames';\nimport { FilterDropdown, FieldLabel } from '@ant-design/pro-utils';\nimport { useIntl } from '@ant-design/pro-provider';\nimport { FilterOutlined } from '@ant-design/icons';\nimport omit from 'omit.js';\nimport BaseForm from '../../BaseForm';\nimport './index.less';\n/**\n * 单行的查询表单，一般用于配合 table 或者 list使用 有时也会用于 card 的额外区域\n *\n * @param props\n */\n\nvar LightFilterContainer = function LightFilterContainer(props) {\n  var items = props.items,\n      prefixCls = props.prefixCls,\n      _props$size = props.size,\n      size = _props$size === void 0 ? 'middle' : _props$size,\n      collapse = props.collapse,\n      collapseLabel = props.collapseLabel,\n      onValuesChange = props.onValuesChange,\n      bordered = props.bordered,\n      _props$values = props.values,\n      values = _props$values === void 0 ? {} : _props$values,\n      footerRender = props.footerRender;\n  var intl = useIntl();\n  var lightFilterClassName = \"\".concat(prefixCls, \"-light-filter\");\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      open = _useState2[0],\n      setOpen = _useState2[1];\n\n  var _useState3 = useState(function () {\n    return _objectSpread({}, values);\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      moreValues = _useState4[0],\n      setMoreValues = _useState4[1];\n\n  useEffect(function () {\n    setMoreValues(_objectSpread({}, values));\n  }, [values]);\n\n  var _useMemo = useMemo(function () {\n    var collapseItemsArr = [];\n    var outsideItemsArr = [];\n    items.forEach(function (item) {\n      var _ref = item.props || {},\n          secondary = _ref.secondary;\n\n      if (secondary || collapse) {\n        collapseItemsArr.push(item);\n      } else {\n        outsideItemsArr.push(item);\n      }\n    });\n    return {\n      collapseItems: collapseItemsArr,\n      outsideItems: outsideItemsArr\n    }; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [props.items.length]),\n      collapseItems = _useMemo.collapseItems,\n      outsideItems = _useMemo.outsideItems;\n\n  var collapseLabelRender = function collapseLabelRender() {\n    if (collapseLabel) {\n      return collapseLabel;\n    }\n\n    if (collapse) {\n      return /*#__PURE__*/React.createElement(FilterOutlined, {\n        className: \"\".concat(lightFilterClassName, \"-collapse-icon\")\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(FieldLabel, {\n      size: size,\n      label: intl.getMessage('form.lightFilter.more', '更多筛选'),\n      expanded: open\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classNames(lightFilterClassName, \"\".concat(lightFilterClassName, \"-\").concat(size), _defineProperty({}, \"\".concat(lightFilterClassName, \"-effective\"), Object.keys(values).some(function (key) {\n      return values[key];\n    })))\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(lightFilterClassName, \"-container\")\n  }, outsideItems.map(function (child, index) {\n    var key = child.key;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(lightFilterClassName, \"-item\"),\n      key: key || index\n    }, /*#__PURE__*/React.cloneElement(child, {\n      // proFieldProps 会直接作为 ProField 的 props 传递过去\n      proFieldProps: {\n        light: true,\n        label: child.props.label,\n        bordered: bordered\n      },\n      bordered: bordered\n    }));\n  }), collapseItems.length ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(lightFilterClassName, \"-item\"),\n    key: \"more\"\n  }, /*#__PURE__*/React.createElement(FilterDropdown, {\n    padding: 24,\n    onVisibleChange: setOpen,\n    visible: open,\n    label: collapseLabelRender(),\n    footerRender: footerRender,\n    footer: {\n      onConfirm: function onConfirm() {\n        onValuesChange(_objectSpread({}, moreValues));\n        setOpen(false);\n      },\n      onClear: function onClear() {\n        var clearValues = {};\n        collapseItems.forEach(function (child) {\n          var name = child.props.name;\n          clearValues[name] = undefined;\n        });\n        onValuesChange(clearValues);\n      }\n    }\n  }, collapseItems.map(function (child) {\n    var key = child.key;\n    var _child$props = child.props,\n        name = _child$props.name,\n        fieldProps = _child$props.fieldProps;\n\n    var newFieldProps = _objectSpread(_objectSpread({}, fieldProps), {}, {\n      onChange: function onChange(e) {\n        setMoreValues(_objectSpread(_objectSpread({}, moreValues), {}, _defineProperty({}, name, (e === null || e === void 0 ? void 0 : e.target) ? e.target.value : e)));\n        return false;\n      }\n    });\n\n    if (moreValues.hasOwnProperty(name)) {\n      newFieldProps[child.props.valuePropName || 'value'] = moreValues[name];\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"\".concat(lightFilterClassName, \"-line\"),\n      key: key\n    }, /*#__PURE__*/React.cloneElement(child, {\n      fieldProps: newFieldProps\n    }));\n  }))) : null));\n};\n\nfunction LightFilter(props) {\n  var size = props.size,\n      collapse = props.collapse,\n      collapseLabel = props.collapseLabel,\n      initialValues = props.initialValues,\n      _onValuesChange = props.onValuesChange,\n      userForm = props.form,\n      userFormRef = props.formRef,\n      bordered = props.bordered,\n      ignoreRules = props.ignoreRules,\n      footerRender = props.footerRender,\n      reset = _objectWithoutProperties(props, _excluded);\n\n  var _useContext = useContext(_ConfigProvider.ConfigContext),\n      getPrefixCls = _useContext.getPrefixCls;\n\n  var prefixCls = getPrefixCls('pro-form');\n\n  var _useState5 = useState(function () {\n    return _objectSpread({}, initialValues);\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      values = _useState6[0],\n      setValues = _useState6[1];\n\n  var formRef = useRef();\n  useImperativeHandle(userFormRef, function () {\n    return formRef.current;\n  });\n  return /*#__PURE__*/React.createElement(BaseForm, _extends({\n    size: size,\n    initialValues: initialValues,\n    form: userForm,\n    contentRender: function contentRender(items) {\n      return /*#__PURE__*/React.createElement(LightFilterContainer, {\n        prefixCls: prefixCls,\n        items: items.flatMap(function (item) {\n          if ((item === null || item === void 0 ? void 0 : item.type.displayName) === 'ProForm-Group') {\n            return item.props.children;\n          }\n\n          return item;\n        }),\n        size: size,\n        bordered: bordered,\n        collapse: collapse,\n        collapseLabel: collapseLabel,\n        values: values,\n        footerRender: footerRender,\n        onValuesChange: function onValuesChange(newValues) {\n          var _formRef$current, _formRef$current2;\n\n          var newAllValues = _objectSpread(_objectSpread({}, values), newValues);\n\n          setValues(newAllValues);\n          (_formRef$current = formRef.current) === null || _formRef$current === void 0 ? void 0 : _formRef$current.setFieldsValue(newAllValues);\n          (_formRef$current2 = formRef.current) === null || _formRef$current2 === void 0 ? void 0 : _formRef$current2.submit();\n\n          if (_onValuesChange) {\n            _onValuesChange(newValues, newAllValues);\n          }\n        }\n      });\n    },\n    formRef: formRef,\n    formItemProps: {\n      colon: false,\n      labelAlign: 'left'\n    },\n    fieldProps: {\n      style: {\n        width: undefined\n      }\n    }\n  }, omit(reset, ['labelWidth']), {\n    onValuesChange: function onValuesChange(_, allValues) {\n      var _formRef$current3;\n\n      setValues(allValues);\n\n      if (_onValuesChange) {\n        _onValuesChange(_, allValues);\n      }\n\n      (_formRef$current3 = formRef.current) === null || _formRef$current3 === void 0 ? void 0 : _formRef$current3.submit();\n    }\n  }));\n}\n\nexport default LightFilter;"]},"metadata":{},"sourceType":"module"}