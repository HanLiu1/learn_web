{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport React from 'react';\nimport get from \"rc-util/es/utils/get\";\nimport namePathSet from \"rc-util/es/utils/set\";\nimport isNil from '../isNil';\nimport { merge } from '../merge';\n\nvar transformKeySubmitValue = function transformKeySubmitValue(values, dataFormatMapRaw) {\n  var omit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true; // ignore nil transform\n\n  var dataFormatMap = Object.keys(dataFormatMapRaw).reduce(function (ret, key) {\n    var value = dataFormatMapRaw[key];\n\n    if (!isNil(value)) {\n      // eslint-disable-next-line no-param-reassign\n      ret[key] = value; // can't be undefined\n    }\n\n    return ret;\n  }, {});\n\n  if (Object.keys(dataFormatMap).length < 1) {\n    return values;\n  }\n\n  if (typeof window === 'undefined') return values; // 如果 value 是 string | null | Blob类型 其中之一，直接返回\n  // 形如 {key: [File, File]} 的表单字段当进行第二次递归时会导致其直接越过 typeof value !== 'object' 这一判断 https://github.com/ant-design/pro-components/issues/2071\n\n  if (_typeof(values) !== 'object' || isNil(values) || values instanceof Blob) {\n    return values;\n  }\n\n  var finalValues = {};\n\n  var gen = function gen(tempValues, parentsKey) {\n    var result = {};\n\n    if (tempValues == null || tempValues === undefined) {\n      return result;\n    }\n\n    Object.keys(tempValues).forEach(function (entityKey) {\n      var key = parentsKey ? [parentsKey, entityKey].flat(1) : [entityKey].flat(1);\n      var itemValue = tempValues[entityKey];\n      var transformFunction = get(dataFormatMap, key);\n\n      var transform = function transform() {\n        var tempKey = typeof transformFunction === 'function' ? transformFunction === null || transformFunction === void 0 ? void 0 : transformFunction(itemValue, entityKey, tempValues) : entityKey; // { [key:string]:any } 数组也能通过编译\n\n        if (Array.isArray(tempKey)) {\n          result = namePathSet(result, tempKey, itemValue);\n          return;\n        }\n\n        if (_typeof(tempKey) === 'object') {\n          finalValues = _objectSpread(_objectSpread({}, finalValues), tempKey);\n        } else if (tempKey) {\n          result = namePathSet(result, [tempKey], itemValue);\n        }\n      };\n      /** 如果存在转化器提前渲染一下 */\n\n\n      if (transformFunction && typeof transformFunction === 'function') {\n        transform();\n      }\n\n      if (typeof window === 'undefined') return;\n\n      if (_typeof(itemValue) === 'object' && !Array.isArray(itemValue) && ! /*#__PURE__*/React.isValidElement(itemValue) && // ignore walk throungh React Element\n      !(itemValue instanceof Blob) // ignore walk throungh Blob\n      ) {\n          var genValues = gen(itemValue, key);\n\n          if (Object.keys(genValues).length < 1) {\n            return;\n          }\n\n          result = namePathSet(result, [entityKey], genValues);\n          return;\n        }\n\n      transform();\n    }); // namePath、transform在omit为false时需正常返回 https://github.com/ant-design/pro-components/issues/2901#issue-908097115\n\n    return omit ? result : tempValues;\n  };\n\n  finalValues = merge({}, gen(values), finalValues);\n  return finalValues;\n};\n\nexport default transformKeySubmitValue;","map":{"version":3,"sources":["C:/web/my-app/node_modules/@ant-design/pro-utils/es/transformKeySubmitValue/index.js"],"names":["_objectSpread","_typeof","React","get","namePathSet","isNil","merge","transformKeySubmitValue","values","dataFormatMapRaw","omit","arguments","length","undefined","dataFormatMap","Object","keys","reduce","ret","key","value","window","Blob","finalValues","gen","tempValues","parentsKey","result","forEach","entityKey","flat","itemValue","transformFunction","transform","tempKey","Array","isArray","isValidElement","genValues"],"mappings":"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","sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport React from 'react';\nimport get from \"rc-util/es/utils/get\";\nimport namePathSet from \"rc-util/es/utils/set\";\nimport isNil from '../isNil';\nimport { merge } from '../merge';\n\nvar transformKeySubmitValue = function transformKeySubmitValue(values, dataFormatMapRaw) {\n  var omit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  // ignore nil transform\n  var dataFormatMap = Object.keys(dataFormatMapRaw).reduce(function (ret, key) {\n    var value = dataFormatMapRaw[key];\n\n    if (!isNil(value)) {\n      // eslint-disable-next-line no-param-reassign\n      ret[key] = value; // can't be undefined\n    }\n\n    return ret;\n  }, {});\n\n  if (Object.keys(dataFormatMap).length < 1) {\n    return values;\n  }\n\n  if (typeof window === 'undefined') return values; // 如果 value 是 string | null | Blob类型 其中之一，直接返回\n  // 形如 {key: [File, File]} 的表单字段当进行第二次递归时会导致其直接越过 typeof value !== 'object' 这一判断 https://github.com/ant-design/pro-components/issues/2071\n\n  if (_typeof(values) !== 'object' || isNil(values) || values instanceof Blob) {\n    return values;\n  }\n\n  var finalValues = {};\n\n  var gen = function gen(tempValues, parentsKey) {\n    var result = {};\n\n    if (tempValues == null || tempValues === undefined) {\n      return result;\n    }\n\n    Object.keys(tempValues).forEach(function (entityKey) {\n      var key = parentsKey ? [parentsKey, entityKey].flat(1) : [entityKey].flat(1);\n      var itemValue = tempValues[entityKey];\n      var transformFunction = get(dataFormatMap, key);\n\n      var transform = function transform() {\n        var tempKey = typeof transformFunction === 'function' ? transformFunction === null || transformFunction === void 0 ? void 0 : transformFunction(itemValue, entityKey, tempValues) : entityKey; // { [key:string]:any } 数组也能通过编译\n\n        if (Array.isArray(tempKey)) {\n          result = namePathSet(result, tempKey, itemValue);\n          return;\n        }\n\n        if (_typeof(tempKey) === 'object') {\n          finalValues = _objectSpread(_objectSpread({}, finalValues), tempKey);\n        } else if (tempKey) {\n          result = namePathSet(result, [tempKey], itemValue);\n        }\n      };\n      /** 如果存在转化器提前渲染一下 */\n\n\n      if (transformFunction && typeof transformFunction === 'function') {\n        transform();\n      }\n\n      if (typeof window === 'undefined') return;\n\n      if (_typeof(itemValue) === 'object' && !Array.isArray(itemValue) && ! /*#__PURE__*/React.isValidElement(itemValue) && // ignore walk throungh React Element\n      !(itemValue instanceof Blob) // ignore walk throungh Blob\n      ) {\n        var genValues = gen(itemValue, key);\n\n        if (Object.keys(genValues).length < 1) {\n          return;\n        }\n\n        result = namePathSet(result, [entityKey], genValues);\n        return;\n      }\n\n      transform();\n    }); // namePath、transform在omit为false时需正常返回 https://github.com/ant-design/pro-components/issues/2901#issue-908097115\n\n    return omit ? result : tempValues;\n  };\n\n  finalValues = merge({}, gen(values), finalValues);\n  return finalValues;\n};\n\nexport default transformKeySubmitValue;"]},"metadata":{},"sourceType":"module"}