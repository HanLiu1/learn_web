{"ast":null,"code":"import \"antd/es/spin/style\";\nimport _Spin from \"antd/es/spin\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"children\", \"contentRender\", \"submitter\", \"fieldProps\", \"formItemProps\", \"groupProps\", \"dateFormatter\", \"formRef\", \"onInit\", \"form\", \"formComponentType\", \"extraUrlParams\", \"syncToUrl\", \"syncToInitialValues\", \"onReset\", \"omitNil\", \"isKeyPressSubmit\", \"autoFocusFirstInput\"],\n    _excluded2 = [\"request\", \"params\", \"initialValues\", \"formKey\"];\nimport React, { useRef, useEffect, useImperativeHandle, useState, useMemo, useCallback } from 'react';\nimport { ConfigProviderWrap } from '@ant-design/pro-provider';\nimport { conversionMomentValue, transformKeySubmitValue, useMountMergeState, ProFormContext, runFunction, useFetchData, isDeepEqualReact, usePrevious } from '@ant-design/pro-utils';\nimport { useUrlSearchParams } from '@umijs/use-params';\nimport namePathSet from \"rc-util/es/utils/set\";\nimport FieldContext from '../FieldContext';\nimport Submitter from '../components/Submitter';\nimport { noteOnce } from \"rc-util/es/warning\";\n\nvar genParams = function genParams(syncUrl, params, type) {\n  if (syncUrl === true) {\n    return params;\n  }\n\n  return runFunction(syncUrl, params, type);\n};\n\nfunction BaseForm(props) {\n  var children = props.children,\n      contentRender = props.contentRender,\n      submitter = props.submitter,\n      fieldProps = props.fieldProps,\n      formItemProps = props.formItemProps,\n      groupProps = props.groupProps,\n      _props$dateFormatter = props.dateFormatter,\n      dateFormatter = _props$dateFormatter === void 0 ? 'string' : _props$dateFormatter,\n      propsFormRef = props.formRef,\n      onInit = props.onInit,\n      form = props.form,\n      formComponentType = props.formComponentType,\n      _props$extraUrlParams = props.extraUrlParams,\n      extraUrlParams = _props$extraUrlParams === void 0 ? {} : _props$extraUrlParams,\n      syncToUrl = props.syncToUrl,\n      _props$syncToInitialV = props.syncToInitialValues,\n      syncToInitialValues = _props$syncToInitialV === void 0 ? true : _props$syncToInitialV,\n      _onReset = props.onReset,\n      _props$omitNil = props.omitNil,\n      omitNil = _props$omitNil === void 0 ? true : _props$omitNil,\n      isKeyPressSubmit = props.isKeyPressSubmit,\n      autoFocusFirstInput = props.autoFocusFirstInput,\n      rest = _objectWithoutProperties(props, _excluded);\n\n  var _Form$useForm = _Form.useForm(form),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      inlineForm = _Form$useForm2[0];\n  /** 同步 url 上的参数 */\n\n\n  var _useUrlSearchParams = useUrlSearchParams({}, {\n    disabled: !syncToUrl\n  }),\n      _useUrlSearchParams2 = _slicedToArray(_useUrlSearchParams, 2),\n      urlSearch = _useUrlSearchParams2[0],\n      setUrlSearch = _useUrlSearchParams2[1];\n\n  var formRef = useRef(inlineForm || {});\n  var fieldsValueType = useRef({});\n  /** 保存 transformKeyRef，用于对表单key transform */\n\n  var transformKeyRef = useRef({});\n  /** 使用 callback 的类型 */\n\n  var transformKey = useCallback(function (values, omit, parentKey) {\n    return transformKeySubmitValue(conversionMomentValue(values, dateFormatter, fieldsValueType.current, omit, parentKey), transformKeyRef.current, omit);\n  }, [dateFormatter]);\n  var formatValues = useMemo(function () {\n    return {\n      /** 获取格式化之后所有数据 */\n      getFieldsFormatValue: function getFieldsFormatValue(nameList) {\n        var _formRef$current;\n\n        return transformKey((_formRef$current = formRef.current) === null || _formRef$current === void 0 ? void 0 : _formRef$current.getFieldsValue(nameList), omitNil);\n      },\n\n      /** 获取格式化之后的单个数据 */\n      getFieldFormatValue: function getFieldFormatValue(nameList) {\n        var _formRef$current2;\n\n        return transformKey((_formRef$current2 = formRef.current) === null || _formRef$current2 === void 0 ? void 0 : _formRef$current2.getFieldValue(nameList), omitNil, nameList);\n      },\n\n      /** 校验字段后返回格式化之后的所有数据 */\n      validateFieldsReturnFormatValue: function () {\n        var _validateFieldsReturnFormatValue = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(nameList) {\n          var _formRef$current3;\n\n          var values;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.next = 2;\n                  return (_formRef$current3 = formRef.current) === null || _formRef$current3 === void 0 ? void 0 : _formRef$current3.validateFields(nameList);\n\n                case 2:\n                  values = _context.sent;\n                  return _context.abrupt(\"return\", transformKey(values, omitNil));\n\n                case 4:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        function validateFieldsReturnFormatValue(_x) {\n          return _validateFieldsReturnFormatValue.apply(this, arguments);\n        }\n\n        return validateFieldsReturnFormatValue;\n      }()\n    };\n  }, [omitNil, transformKey]);\n  /** 利用反射把值传的到处都是，并且总是新的 */\n\n  var responseForm = useMemo(function () {\n    var response = _objectSpread({}, formRef.current);\n\n    Object.keys(formRef.current || {}).forEach(function (key) {\n      Object.defineProperty(response, key, {\n        get: function get() {\n          return formRef.current[key];\n        }\n      });\n    });\n    Object.keys(formatValues).forEach(function (key) {\n      Object.defineProperty(response, key, {\n        get: function get() {\n          return formatValues[key];\n        }\n      });\n    });\n    return response; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  var _useMountMergeState = useMountMergeState(false),\n      _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n      loading = _useMountMergeState2[0],\n      setLoading = _useMountMergeState2[1];\n\n  var items = React.Children.toArray(children).map(function (item, index) {\n    if (index === 0 && /*#__PURE__*/React.isValidElement(item) && autoFocusFirstInput) {\n      return /*#__PURE__*/React.cloneElement(item, _objectSpread(_objectSpread({}, item.props), {}, {\n        autoFocus: autoFocusFirstInput\n      }));\n    }\n\n    return item;\n  });\n  /** 计算 props 的对象 */\n\n  var submitterProps = useMemo(function () {\n    return typeof submitter === 'boolean' || !submitter ? {} : submitter;\n  }, [submitter]); // 初始化给一个默认的 form\n\n  useImperativeHandle(propsFormRef, function () {\n    return responseForm;\n  });\n  /** 渲染提交按钮与重置按钮 */\n\n  var submitterNode = useMemo(function () {\n    if (submitter === false) return undefined;\n    return /*#__PURE__*/React.createElement(Submitter, _extends({\n      key: \"submitter\"\n    }, submitterProps, {\n      onReset: function onReset() {\n        var _formRef$current4, _submitterProps$onRes;\n\n        var finalValues = transformKey((_formRef$current4 = formRef.current) === null || _formRef$current4 === void 0 ? void 0 : _formRef$current4.getFieldsValue(), omitNil);\n        submitterProps === null || submitterProps === void 0 ? void 0 : (_submitterProps$onRes = submitterProps.onReset) === null || _submitterProps$onRes === void 0 ? void 0 : _submitterProps$onRes.call(submitterProps, finalValues);\n        _onReset === null || _onReset === void 0 ? void 0 : _onReset(finalValues); // 如果 syncToUrl，清空一下数据\n\n        if (syncToUrl) {\n          var _formRef$current5; // 把没有的值设置为未定义可以删掉 url 的参数\n\n\n          var params = Object.keys(transformKey((_formRef$current5 = formRef.current) === null || _formRef$current5 === void 0 ? void 0 : _formRef$current5.getFieldsValue(), false)).reduce(function (pre, next) {\n            return _objectSpread(_objectSpread({}, pre), {}, _defineProperty({}, next, finalValues[next] || undefined));\n          }, extraUrlParams);\n          /** 在同步到 url 上时对参数进行转化 */\n\n          setUrlSearch(genParams(syncToUrl, params, 'set'));\n        }\n      },\n      form: responseForm,\n      submitButtonProps: _objectSpread({\n        loading: loading\n      }, submitterProps.submitButtonProps)\n    }));\n  }, [submitter, submitterProps, responseForm, loading, transformKey, omitNil, _onReset, syncToUrl, extraUrlParams, setUrlSearch]);\n  var content = useMemo(function () {\n    if (contentRender) {\n      return contentRender(items, submitterNode, formRef.current);\n    }\n\n    return items;\n  }, [contentRender, items, submitterNode]);\n  var getPopupContainer = useMemo(function () {\n    if (typeof window === 'undefined') return undefined; // 如果在 drawerForm 和  modalForm 里就渲染dom到父节点里\n    // modalForm 可能高度太小不适合\n\n    if (formComponentType && ['DrawerForm'].includes(formComponentType)) {\n      return function (e) {\n        return e.parentNode || document.body;\n      };\n    }\n\n    return undefined;\n  }, [formComponentType]);\n  useEffect(function () {\n    var _formRef$current6;\n\n    var finalValues = transformKey((_formRef$current6 = formRef.current) === null || _formRef$current6 === void 0 ? void 0 : _formRef$current6.getFieldsValue(true), omitNil);\n    onInit === null || onInit === void 0 ? void 0 : onInit(finalValues, responseForm); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []); // 如果为 false，不需要触发设置进去\n\n  var _useState = useState(function () {\n    if (!syncToUrl) {\n      return {};\n    }\n\n    return genParams(syncToUrl, urlSearch, 'get');\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      urlParamsMergeInitialValues = _useState2[0],\n      setUrlParamsMergeInitialValues = _useState2[1];\n\n  useEffect(function () {\n    if (syncToInitialValues) return;\n    setUrlParamsMergeInitialValues({});\n  }, [syncToInitialValues]);\n  var preInitialValues = usePrevious(props.initialValues); // 提示一个 initialValues ，问的人实在是太多了\n\n  useEffect(function () {\n    if (syncToUrl || !props.initialValues || !preInitialValues || rest.request) return;\n    var isEqual = isDeepEqualReact(props.initialValues, preInitialValues);\n    noteOnce(isEqual, \"initialValues \\u53EA\\u5728 form \\u521D\\u59CB\\u5316\\u65F6\\u751F\\u6548\\uFF0C\\u5982\\u679C\\u4F60\\u9700\\u8981\\u5F02\\u6B65\\u52A0\\u8F7D\\u63A8\\u8350\\u4F7F\\u7528 request\\uFF0C\\u6216\\u8005 initialValues ? <Form/> : null \");\n    noteOnce(isEqual, \"The initialValues only take effect when the form is initialized, if you need to load asynchronously recommended request, or the initialValues ? <Form/> : null \"); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [props.initialValues]);\n  useEffect(function () {\n    if (!syncToUrl) return;\n    setUrlSearch(_objectSpread(_objectSpread({}, urlSearch), extraUrlParams)); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [extraUrlParams, syncToUrl]);\n  return (\n    /*#__PURE__*/\n    // 增加国际化的能力，与 table 组件可以统一\n    React.createElement(ConfigProviderWrap, null, /*#__PURE__*/React.createElement(FieldContext.Provider, {\n      value: {\n        formRef: formRef,\n        fieldProps: fieldProps,\n        formItemProps: formItemProps,\n        groupProps: groupProps,\n        formComponentType: formComponentType,\n        getPopupContainer: getPopupContainer,\n        setFieldValueType: function setFieldValueType(name, _ref) {\n          var _ref$valueType = _ref.valueType,\n              valueType = _ref$valueType === void 0 ? 'text' : _ref$valueType,\n              dateFormat = _ref.dateFormat,\n              transform = _ref.transform;\n          if (!Array.isArray(name)) return;\n          transformKeyRef.current = namePathSet(transformKeyRef.current, name, transform);\n          fieldsValueType.current = namePathSet(fieldsValueType.current, name, {\n            valueType: valueType,\n            dateFormat: dateFormat\n          });\n        }\n      }\n    }, /*#__PURE__*/React.createElement(ProFormContext.Provider, {\n      value: formatValues\n    }, /*#__PURE__*/React.createElement(_ConfigProvider.SizeContext.Provider, {\n      value: rest.size\n    }, /*#__PURE__*/React.createElement(_Form, _extends({\n      onKeyPress: function onKeyPress(event) {\n        if (!isKeyPressSubmit) return;\n\n        if (event.key === 'Enter') {\n          var _formRef$current7;\n\n          (_formRef$current7 = formRef.current) === null || _formRef$current7 === void 0 ? void 0 : _formRef$current7.submit();\n        }\n      },\n      form: inlineForm\n    }, rest, {\n      // 组合 urlSearch 和 initialValues\n      initialValues: _objectSpread(_objectSpread({}, urlParamsMergeInitialValues), rest.initialValues),\n      onValuesChange: function onValuesChange(changedValues, values) {\n        var _rest$onValuesChange;\n\n        rest === null || rest === void 0 ? void 0 : (_rest$onValuesChange = rest.onValuesChange) === null || _rest$onValuesChange === void 0 ? void 0 : _rest$onValuesChange.call(rest, transformKey(changedValues, omitNil), transformKey(values, omitNil));\n      },\n      onFinish: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var _formRef$current8, finalValues, _formRef$current9, params;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (rest.onFinish) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 2:\n                if (!loading) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 4:\n                setLoading(true);\n                _context2.prev = 5;\n                finalValues = transformKey((_formRef$current8 = formRef.current) === null || _formRef$current8 === void 0 ? void 0 : _formRef$current8.getFieldsValue(), omitNil);\n                _context2.next = 9;\n                return rest.onFinish(finalValues);\n\n              case 9:\n                if (syncToUrl) {\n                  // 把没有的值设置为未定义可以删掉 url 的参数\n                  params = Object.keys(transformKey((_formRef$current9 = formRef.current) === null || _formRef$current9 === void 0 ? void 0 : _formRef$current9.getFieldsValue(), false)).reduce(function (pre, next) {\n                    var _finalValues$next;\n\n                    return _objectSpread(_objectSpread({}, pre), {}, _defineProperty({}, next, (_finalValues$next = finalValues[next]) !== null && _finalValues$next !== void 0 ? _finalValues$next : undefined));\n                  }, extraUrlParams); // fix #3547: 当原先在url中存在的字段被删除时，应该将 params 中的该字段设置为 undefined,以便触发url同步删除\n\n                  Object.keys(urlSearch).forEach(function (key) {\n                    if (params[key] !== false || params[key] !== 0 || !params[key]) {\n                      params[key] = undefined;\n                    }\n                  });\n                  /** 在同步到 url 上时对参数进行转化 */\n\n                  setUrlSearch(genParams(syncToUrl, params, 'set'));\n                }\n\n                setLoading(false);\n                _context2.next = 16;\n                break;\n\n              case 13:\n                _context2.prev = 13;\n                _context2.t0 = _context2[\"catch\"](5); // console.log(error);\n\n                setLoading(false);\n\n              case 16:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[5, 13]]);\n      }))\n    }), rest.component !== false && /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      style: {\n        display: 'none'\n      }\n    }), /*#__PURE__*/React.createElement(_Form.Item, {\n      noStyle: true,\n      shouldUpdate: true\n    }, function (formInstance) {\n      if (propsFormRef) propsFormRef.current = _objectSpread(_objectSpread({}, formInstance), formatValues);\n      formRef.current = formInstance;\n      return null;\n    }), content)))))\n  );\n}\n\nfunction RequestForm(props) {\n  var request = props.request,\n      params = props.params,\n      initialValues = props.initialValues,\n      formKey = props.formKey,\n      rest = _objectWithoutProperties(props, _excluded2);\n\n  var _useFetchData = useFetchData({\n    request: request,\n    params: params,\n    proFieldKey: formKey\n  }),\n      _useFetchData2 = _slicedToArray(_useFetchData, 1),\n      initialData = _useFetchData2[0];\n\n  if (!initialData && props.request) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        paddingTop: 50,\n        paddingBottom: 50,\n        textAlign: 'center'\n      }\n    }, /*#__PURE__*/React.createElement(_Spin, null));\n  }\n\n  return /*#__PURE__*/React.createElement(BaseForm, _extends({\n    autoComplete: \"off\"\n  }, rest, {\n    initialValues: _objectSpread(_objectSpread({}, initialValues), initialData)\n  }));\n}\n\nexport default RequestForm;","map":{"version":3,"sources":["C:/web/my-app/node_modules/@ant-design/pro-form/es/BaseForm/index.js"],"names":["_Spin","_ConfigProvider","_extends","_defineProperty","_objectSpread","_regeneratorRuntime","_asyncToGenerator","_Form","_slicedToArray","_objectWithoutProperties","_excluded","_excluded2","React","useRef","useEffect","useImperativeHandle","useState","useMemo","useCallback","ConfigProviderWrap","conversionMomentValue","transformKeySubmitValue","useMountMergeState","ProFormContext","runFunction","useFetchData","isDeepEqualReact","usePrevious","useUrlSearchParams","namePathSet","FieldContext","Submitter","noteOnce","genParams","syncUrl","params","type","BaseForm","props","children","contentRender","submitter","fieldProps","formItemProps","groupProps","_props$dateFormatter","dateFormatter","propsFormRef","formRef","onInit","form","formComponentType","_props$extraUrlParams","extraUrlParams","syncToUrl","_props$syncToInitialV","syncToInitialValues","_onReset","onReset","_props$omitNil","omitNil","isKeyPressSubmit","autoFocusFirstInput","rest","_Form$useForm","useForm","_Form$useForm2","inlineForm","_useUrlSearchParams","disabled","_useUrlSearchParams2","urlSearch","setUrlSearch","fieldsValueType","transformKeyRef","transformKey","values","omit","parentKey","current","formatValues","getFieldsFormatValue","nameList","_formRef$current","getFieldsValue","getFieldFormatValue","_formRef$current2","getFieldValue","validateFieldsReturnFormatValue","_validateFieldsReturnFormatValue","mark","_callee","_formRef$current3","wrap","_callee$","_context","prev","next","validateFields","sent","abrupt","stop","_x","apply","arguments","responseForm","response","Object","keys","forEach","key","defineProperty","get","_useMountMergeState","_useMountMergeState2","loading","setLoading","items","Children","toArray","map","item","index","isValidElement","cloneElement","autoFocus","submitterProps","submitterNode","undefined","createElement","_formRef$current4","_submitterProps$onRes","finalValues","call","_formRef$current5","reduce","pre","submitButtonProps","content","getPopupContainer","window","includes","e","parentNode","document","body","_formRef$current6","_useState","_useState2","urlParamsMergeInitialValues","setUrlParamsMergeInitialValues","preInitialValues","initialValues","request","isEqual","Provider","value","setFieldValueType","name","_ref","_ref$valueType","valueType","dateFormat","transform","Array","isArray","SizeContext","size","onKeyPress","event","_formRef$current7","submit","onValuesChange","changedValues","_rest$onValuesChange","onFinish","_callee2","_formRef$current8","_formRef$current9","_callee2$","_context2","_finalValues$next","t0","component","style","display","Item","noStyle","shouldUpdate","formInstance","RequestForm","formKey","_useFetchData","proFieldKey","_useFetchData2","initialData","paddingTop","paddingBottom","textAlign","autoComplete"],"mappings":"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","sourcesContent":["import \"antd/es/spin/style\";\nimport _Spin from \"antd/es/spin\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"children\", \"contentRender\", \"submitter\", \"fieldProps\", \"formItemProps\", \"groupProps\", \"dateFormatter\", \"formRef\", \"onInit\", \"form\", \"formComponentType\", \"extraUrlParams\", \"syncToUrl\", \"syncToInitialValues\", \"onReset\", \"omitNil\", \"isKeyPressSubmit\", \"autoFocusFirstInput\"],\n    _excluded2 = [\"request\", \"params\", \"initialValues\", \"formKey\"];\nimport React, { useRef, useEffect, useImperativeHandle, useState, useMemo, useCallback } from 'react';\nimport { ConfigProviderWrap } from '@ant-design/pro-provider';\nimport { conversionMomentValue, transformKeySubmitValue, useMountMergeState, ProFormContext, runFunction, useFetchData, isDeepEqualReact, usePrevious } from '@ant-design/pro-utils';\nimport { useUrlSearchParams } from '@umijs/use-params';\nimport namePathSet from \"rc-util/es/utils/set\";\nimport FieldContext from '../FieldContext';\nimport Submitter from '../components/Submitter';\nimport { noteOnce } from \"rc-util/es/warning\";\n\nvar genParams = function genParams(syncUrl, params, type) {\n  if (syncUrl === true) {\n    return params;\n  }\n\n  return runFunction(syncUrl, params, type);\n};\n\nfunction BaseForm(props) {\n  var children = props.children,\n      contentRender = props.contentRender,\n      submitter = props.submitter,\n      fieldProps = props.fieldProps,\n      formItemProps = props.formItemProps,\n      groupProps = props.groupProps,\n      _props$dateFormatter = props.dateFormatter,\n      dateFormatter = _props$dateFormatter === void 0 ? 'string' : _props$dateFormatter,\n      propsFormRef = props.formRef,\n      onInit = props.onInit,\n      form = props.form,\n      formComponentType = props.formComponentType,\n      _props$extraUrlParams = props.extraUrlParams,\n      extraUrlParams = _props$extraUrlParams === void 0 ? {} : _props$extraUrlParams,\n      syncToUrl = props.syncToUrl,\n      _props$syncToInitialV = props.syncToInitialValues,\n      syncToInitialValues = _props$syncToInitialV === void 0 ? true : _props$syncToInitialV,\n      _onReset = props.onReset,\n      _props$omitNil = props.omitNil,\n      omitNil = _props$omitNil === void 0 ? true : _props$omitNil,\n      isKeyPressSubmit = props.isKeyPressSubmit,\n      autoFocusFirstInput = props.autoFocusFirstInput,\n      rest = _objectWithoutProperties(props, _excluded);\n\n  var _Form$useForm = _Form.useForm(form),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      inlineForm = _Form$useForm2[0];\n  /** 同步 url 上的参数 */\n\n\n  var _useUrlSearchParams = useUrlSearchParams({}, {\n    disabled: !syncToUrl\n  }),\n      _useUrlSearchParams2 = _slicedToArray(_useUrlSearchParams, 2),\n      urlSearch = _useUrlSearchParams2[0],\n      setUrlSearch = _useUrlSearchParams2[1];\n\n  var formRef = useRef(inlineForm || {});\n  var fieldsValueType = useRef({});\n  /** 保存 transformKeyRef，用于对表单key transform */\n\n  var transformKeyRef = useRef({});\n  /** 使用 callback 的类型 */\n\n  var transformKey = useCallback(function (values, omit, parentKey) {\n    return transformKeySubmitValue(conversionMomentValue(values, dateFormatter, fieldsValueType.current, omit, parentKey), transformKeyRef.current, omit);\n  }, [dateFormatter]);\n  var formatValues = useMemo(function () {\n    return {\n      /** 获取格式化之后所有数据 */\n      getFieldsFormatValue: function getFieldsFormatValue(nameList) {\n        var _formRef$current;\n\n        return transformKey((_formRef$current = formRef.current) === null || _formRef$current === void 0 ? void 0 : _formRef$current.getFieldsValue(nameList), omitNil);\n      },\n\n      /** 获取格式化之后的单个数据 */\n      getFieldFormatValue: function getFieldFormatValue(nameList) {\n        var _formRef$current2;\n\n        return transformKey((_formRef$current2 = formRef.current) === null || _formRef$current2 === void 0 ? void 0 : _formRef$current2.getFieldValue(nameList), omitNil, nameList);\n      },\n\n      /** 校验字段后返回格式化之后的所有数据 */\n      validateFieldsReturnFormatValue: function () {\n        var _validateFieldsReturnFormatValue = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(nameList) {\n          var _formRef$current3;\n\n          var values;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _context.next = 2;\n                  return (_formRef$current3 = formRef.current) === null || _formRef$current3 === void 0 ? void 0 : _formRef$current3.validateFields(nameList);\n\n                case 2:\n                  values = _context.sent;\n                  return _context.abrupt(\"return\", transformKey(values, omitNil));\n\n                case 4:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        function validateFieldsReturnFormatValue(_x) {\n          return _validateFieldsReturnFormatValue.apply(this, arguments);\n        }\n\n        return validateFieldsReturnFormatValue;\n      }()\n    };\n  }, [omitNil, transformKey]);\n  /** 利用反射把值传的到处都是，并且总是新的 */\n\n  var responseForm = useMemo(function () {\n    var response = _objectSpread({}, formRef.current);\n\n    Object.keys(formRef.current || {}).forEach(function (key) {\n      Object.defineProperty(response, key, {\n        get: function get() {\n          return formRef.current[key];\n        }\n      });\n    });\n    Object.keys(formatValues).forEach(function (key) {\n      Object.defineProperty(response, key, {\n        get: function get() {\n          return formatValues[key];\n        }\n      });\n    });\n    return response; // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  var _useMountMergeState = useMountMergeState(false),\n      _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n      loading = _useMountMergeState2[0],\n      setLoading = _useMountMergeState2[1];\n\n  var items = React.Children.toArray(children).map(function (item, index) {\n    if (index === 0 && /*#__PURE__*/React.isValidElement(item) && autoFocusFirstInput) {\n      return /*#__PURE__*/React.cloneElement(item, _objectSpread(_objectSpread({}, item.props), {}, {\n        autoFocus: autoFocusFirstInput\n      }));\n    }\n\n    return item;\n  });\n  /** 计算 props 的对象 */\n\n  var submitterProps = useMemo(function () {\n    return typeof submitter === 'boolean' || !submitter ? {} : submitter;\n  }, [submitter]); // 初始化给一个默认的 form\n\n  useImperativeHandle(propsFormRef, function () {\n    return responseForm;\n  });\n  /** 渲染提交按钮与重置按钮 */\n\n  var submitterNode = useMemo(function () {\n    if (submitter === false) return undefined;\n    return /*#__PURE__*/React.createElement(Submitter, _extends({\n      key: \"submitter\"\n    }, submitterProps, {\n      onReset: function onReset() {\n        var _formRef$current4, _submitterProps$onRes;\n\n        var finalValues = transformKey((_formRef$current4 = formRef.current) === null || _formRef$current4 === void 0 ? void 0 : _formRef$current4.getFieldsValue(), omitNil);\n        submitterProps === null || submitterProps === void 0 ? void 0 : (_submitterProps$onRes = submitterProps.onReset) === null || _submitterProps$onRes === void 0 ? void 0 : _submitterProps$onRes.call(submitterProps, finalValues);\n        _onReset === null || _onReset === void 0 ? void 0 : _onReset(finalValues); // 如果 syncToUrl，清空一下数据\n\n        if (syncToUrl) {\n          var _formRef$current5;\n\n          // 把没有的值设置为未定义可以删掉 url 的参数\n          var params = Object.keys(transformKey((_formRef$current5 = formRef.current) === null || _formRef$current5 === void 0 ? void 0 : _formRef$current5.getFieldsValue(), false)).reduce(function (pre, next) {\n            return _objectSpread(_objectSpread({}, pre), {}, _defineProperty({}, next, finalValues[next] || undefined));\n          }, extraUrlParams);\n          /** 在同步到 url 上时对参数进行转化 */\n\n          setUrlSearch(genParams(syncToUrl, params, 'set'));\n        }\n      },\n      form: responseForm,\n      submitButtonProps: _objectSpread({\n        loading: loading\n      }, submitterProps.submitButtonProps)\n    }));\n  }, [submitter, submitterProps, responseForm, loading, transformKey, omitNil, _onReset, syncToUrl, extraUrlParams, setUrlSearch]);\n  var content = useMemo(function () {\n    if (contentRender) {\n      return contentRender(items, submitterNode, formRef.current);\n    }\n\n    return items;\n  }, [contentRender, items, submitterNode]);\n  var getPopupContainer = useMemo(function () {\n    if (typeof window === 'undefined') return undefined; // 如果在 drawerForm 和  modalForm 里就渲染dom到父节点里\n    // modalForm 可能高度太小不适合\n\n    if (formComponentType && ['DrawerForm'].includes(formComponentType)) {\n      return function (e) {\n        return e.parentNode || document.body;\n      };\n    }\n\n    return undefined;\n  }, [formComponentType]);\n  useEffect(function () {\n    var _formRef$current6;\n\n    var finalValues = transformKey((_formRef$current6 = formRef.current) === null || _formRef$current6 === void 0 ? void 0 : _formRef$current6.getFieldsValue(true), omitNil);\n    onInit === null || onInit === void 0 ? void 0 : onInit(finalValues, responseForm); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []); // 如果为 false，不需要触发设置进去\n\n  var _useState = useState(function () {\n    if (!syncToUrl) {\n      return {};\n    }\n\n    return genParams(syncToUrl, urlSearch, 'get');\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      urlParamsMergeInitialValues = _useState2[0],\n      setUrlParamsMergeInitialValues = _useState2[1];\n\n  useEffect(function () {\n    if (syncToInitialValues) return;\n    setUrlParamsMergeInitialValues({});\n  }, [syncToInitialValues]);\n  var preInitialValues = usePrevious(props.initialValues); // 提示一个 initialValues ，问的人实在是太多了\n\n  useEffect(function () {\n    if (syncToUrl || !props.initialValues || !preInitialValues || rest.request) return;\n    var isEqual = isDeepEqualReact(props.initialValues, preInitialValues);\n    noteOnce(isEqual, \"initialValues \\u53EA\\u5728 form \\u521D\\u59CB\\u5316\\u65F6\\u751F\\u6548\\uFF0C\\u5982\\u679C\\u4F60\\u9700\\u8981\\u5F02\\u6B65\\u52A0\\u8F7D\\u63A8\\u8350\\u4F7F\\u7528 request\\uFF0C\\u6216\\u8005 initialValues ? <Form/> : null \");\n    noteOnce(isEqual, \"The initialValues only take effect when the form is initialized, if you need to load asynchronously recommended request, or the initialValues ? <Form/> : null \"); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [props.initialValues]);\n  useEffect(function () {\n    if (!syncToUrl) return;\n    setUrlSearch(_objectSpread(_objectSpread({}, urlSearch), extraUrlParams)); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [extraUrlParams, syncToUrl]);\n  return (\n    /*#__PURE__*/\n    // 增加国际化的能力，与 table 组件可以统一\n    React.createElement(ConfigProviderWrap, null, /*#__PURE__*/React.createElement(FieldContext.Provider, {\n      value: {\n        formRef: formRef,\n        fieldProps: fieldProps,\n        formItemProps: formItemProps,\n        groupProps: groupProps,\n        formComponentType: formComponentType,\n        getPopupContainer: getPopupContainer,\n        setFieldValueType: function setFieldValueType(name, _ref) {\n          var _ref$valueType = _ref.valueType,\n              valueType = _ref$valueType === void 0 ? 'text' : _ref$valueType,\n              dateFormat = _ref.dateFormat,\n              transform = _ref.transform;\n          if (!Array.isArray(name)) return;\n          transformKeyRef.current = namePathSet(transformKeyRef.current, name, transform);\n          fieldsValueType.current = namePathSet(fieldsValueType.current, name, {\n            valueType: valueType,\n            dateFormat: dateFormat\n          });\n        }\n      }\n    }, /*#__PURE__*/React.createElement(ProFormContext.Provider, {\n      value: formatValues\n    }, /*#__PURE__*/React.createElement(_ConfigProvider.SizeContext.Provider, {\n      value: rest.size\n    }, /*#__PURE__*/React.createElement(_Form, _extends({\n      onKeyPress: function onKeyPress(event) {\n        if (!isKeyPressSubmit) return;\n\n        if (event.key === 'Enter') {\n          var _formRef$current7;\n\n          (_formRef$current7 = formRef.current) === null || _formRef$current7 === void 0 ? void 0 : _formRef$current7.submit();\n        }\n      },\n      form: inlineForm\n    }, rest, {\n      // 组合 urlSearch 和 initialValues\n      initialValues: _objectSpread(_objectSpread({}, urlParamsMergeInitialValues), rest.initialValues),\n      onValuesChange: function onValuesChange(changedValues, values) {\n        var _rest$onValuesChange;\n\n        rest === null || rest === void 0 ? void 0 : (_rest$onValuesChange = rest.onValuesChange) === null || _rest$onValuesChange === void 0 ? void 0 : _rest$onValuesChange.call(rest, transformKey(changedValues, omitNil), transformKey(values, omitNil));\n      },\n      onFinish: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var _formRef$current8, finalValues, _formRef$current9, params;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (rest.onFinish) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 2:\n                if (!loading) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 4:\n                setLoading(true);\n                _context2.prev = 5;\n                finalValues = transformKey((_formRef$current8 = formRef.current) === null || _formRef$current8 === void 0 ? void 0 : _formRef$current8.getFieldsValue(), omitNil);\n                _context2.next = 9;\n                return rest.onFinish(finalValues);\n\n              case 9:\n                if (syncToUrl) {\n                  // 把没有的值设置为未定义可以删掉 url 的参数\n                  params = Object.keys(transformKey((_formRef$current9 = formRef.current) === null || _formRef$current9 === void 0 ? void 0 : _formRef$current9.getFieldsValue(), false)).reduce(function (pre, next) {\n                    var _finalValues$next;\n\n                    return _objectSpread(_objectSpread({}, pre), {}, _defineProperty({}, next, (_finalValues$next = finalValues[next]) !== null && _finalValues$next !== void 0 ? _finalValues$next : undefined));\n                  }, extraUrlParams); // fix #3547: 当原先在url中存在的字段被删除时，应该将 params 中的该字段设置为 undefined,以便触发url同步删除\n\n                  Object.keys(urlSearch).forEach(function (key) {\n                    if (params[key] !== false || params[key] !== 0 || !params[key]) {\n                      params[key] = undefined;\n                    }\n                  });\n                  /** 在同步到 url 上时对参数进行转化 */\n\n                  setUrlSearch(genParams(syncToUrl, params, 'set'));\n                }\n\n                setLoading(false);\n                _context2.next = 16;\n                break;\n\n              case 13:\n                _context2.prev = 13;\n                _context2.t0 = _context2[\"catch\"](5);\n                // console.log(error);\n                setLoading(false);\n\n              case 16:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[5, 13]]);\n      }))\n    }), rest.component !== false && /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      style: {\n        display: 'none'\n      }\n    }), /*#__PURE__*/React.createElement(_Form.Item, {\n      noStyle: true,\n      shouldUpdate: true\n    }, function (formInstance) {\n      if (propsFormRef) propsFormRef.current = _objectSpread(_objectSpread({}, formInstance), formatValues);\n      formRef.current = formInstance;\n      return null;\n    }), content)))))\n  );\n}\n\nfunction RequestForm(props) {\n  var request = props.request,\n      params = props.params,\n      initialValues = props.initialValues,\n      formKey = props.formKey,\n      rest = _objectWithoutProperties(props, _excluded2);\n\n  var _useFetchData = useFetchData({\n    request: request,\n    params: params,\n    proFieldKey: formKey\n  }),\n      _useFetchData2 = _slicedToArray(_useFetchData, 1),\n      initialData = _useFetchData2[0];\n\n  if (!initialData && props.request) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        paddingTop: 50,\n        paddingBottom: 50,\n        textAlign: 'center'\n      }\n    }, /*#__PURE__*/React.createElement(_Spin, null));\n  }\n\n  return /*#__PURE__*/React.createElement(BaseForm, _extends({\n    autoComplete: \"off\"\n  }, rest, {\n    initialValues: _objectSpread(_objectSpread({}, initialValues), initialData)\n  }));\n}\n\nexport default RequestForm;"]},"metadata":{},"sourceType":"module"}