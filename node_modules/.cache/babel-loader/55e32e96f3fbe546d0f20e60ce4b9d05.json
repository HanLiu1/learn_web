{"ast":null,"code":"import \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/space/style\";\nimport _Space from \"antd/es/space\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/steps/style\";\nimport _Steps from \"antd/es/steps\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nvar _excluded = [\"current\", \"onCurrentChange\", \"submitter\", \"stepsFormRender\", \"stepsRender\", \"stepFormRender\", \"stepsProps\", \"onFinish\", \"formProps\", \"containerStyle\", \"formRef\", \"formMapRef\"];\nimport React, { useRef, useCallback, useEffect, useContext, useImperativeHandle } from 'react';\nimport toArray from \"rc-util/es/Children/toArray\";\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport classNames from 'classnames';\nimport { ConfigProviderWrap, useIntl } from '@ant-design/pro-provider';\nimport { useMountMergeState, merge } from '@ant-design/pro-utils';\nimport StepForm from './StepForm';\nimport './index.less';\nexport var StepsFormProvide = /*#__PURE__*/React.createContext(undefined);\n\nfunction StepsForm(props) {\n  var _formArrayRef$current;\n\n  var _useContext = useContext(_ConfigProvider.ConfigContext),\n      getPrefixCls = _useContext.getPrefixCls;\n\n  var prefixCls = getPrefixCls('pro-steps-form');\n\n  var current = props.current,\n      onCurrentChange = props.onCurrentChange,\n      submitter = props.submitter,\n      stepsFormRender = props.stepsFormRender,\n      stepsRender = props.stepsRender,\n      stepFormRender = props.stepFormRender,\n      stepsProps = props.stepsProps,\n      onFinish = props.onFinish,\n      formProps = props.formProps,\n      containerStyle = props.containerStyle,\n      formRef = props.formRef,\n      propsFormMapRef = props.formMapRef,\n      rest = _objectWithoutProperties(props, _excluded);\n\n  var formDataRef = useRef(new Map());\n  var formMapRef = useRef(new Map());\n  var formArrayRef = useRef([]);\n\n  var _useMountMergeState = useMountMergeState([]),\n      _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n      formArray = _useMountMergeState2[0],\n      setFormArray = _useMountMergeState2[1];\n\n  var _useMountMergeState3 = useMountMergeState(false),\n      _useMountMergeState4 = _slicedToArray(_useMountMergeState3, 2),\n      loading = _useMountMergeState4[0],\n      setLoading = _useMountMergeState4[1];\n\n  var intl = useIntl();\n  /** 受控的方式来操作表单 */\n\n  var _useMergedState = useMergedState(0, {\n    value: props.current,\n    onChange: props.onCurrentChange\n  }),\n      _useMergedState2 = _slicedToArray(_useMergedState, 2),\n      step = _useMergedState2[0],\n      setStep = _useMergedState2[1];\n  /** 注册一个form进入，方便进行 props 的修改 */\n\n\n  var regForm = useCallback(function (name, childrenFormProps) {\n    formMapRef.current.set(name, childrenFormProps);\n  }, []);\n  /** 接触挂载掉这个 form，同时步数 -1 */\n\n  var unRegForm = useCallback(function (name) {\n    formMapRef.current.delete(name);\n    formDataRef.current.delete(name);\n  }, []);\n  /** Children 计算完成之后，重新生成一下当前的步骤列表 */\n\n  useEffect(function () {\n    setFormArray(Array.from(formMapRef.current.keys())); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [Array.from(formMapRef.current.keys()).join(',')]);\n  var currentFormRef = (_formArrayRef$current = formArrayRef.current[step || 0]) === null || _formArrayRef$current === void 0 ? void 0 : _formArrayRef$current.current;\n  useImperativeHandle(propsFormMapRef, function () {\n    return formArrayRef.current;\n  });\n  useImperativeHandle(formRef, function () {\n    return currentFormRef;\n  });\n  /** ProForm处理了一下 from 的数据，在其中做了一些操作 如果使用 Provider 自带的，自带的数据处理就无法生效了 */\n\n  var onFormFinish = useCallback( /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(name, formData) {\n      var values, success;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              formDataRef.current.set(name, formData); // 如果是最后一步\n\n              if (!(step === formMapRef.current.size - 1 || formMapRef.current.size === 0)) {\n                _context.next = 19;\n                break;\n              }\n\n              if (onFinish) {\n                _context.next = 4;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 4:\n              setLoading(true);\n              values = merge.apply(void 0, [{}].concat(_toConsumableArray(Array.from(formDataRef.current.values()))));\n              _context.prev = 6;\n              _context.next = 9;\n              return onFinish(values);\n\n            case 9:\n              success = _context.sent;\n\n              if (success) {\n                setStep(0);\n                formArrayRef.current.forEach(function (form) {\n                  var _form$current;\n\n                  return (_form$current = form.current) === null || _form$current === void 0 ? void 0 : _form$current.resetFields();\n                });\n              }\n\n              _context.next = 16;\n              break;\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](6); // eslint-disable-next-line no-console\n\n              console.log(_context.t0);\n\n            case 16:\n              _context.prev = 16;\n              setLoading(false);\n              return _context.finish(16);\n\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[6, 13, 16, 19]]);\n    }));\n\n    return function (_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }(), // eslint-disable-next-line react-hooks/exhaustive-deps\n  [step, formMapRef, onFinish]);\n  var stepsDom = /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-steps-container\"),\n    style: {\n      maxWidth: Math.min(formArray.length * 320, 1160)\n    }\n  }, /*#__PURE__*/React.createElement(_Steps, _extends({}, stepsProps, {\n    current: step,\n    onChange: undefined\n  }), formArray.map(function (item) {\n    var itemProps = formMapRef.current.get(item);\n    return /*#__PURE__*/React.createElement(_Steps.Step, _extends({\n      key: item,\n      title: itemProps === null || itemProps === void 0 ? void 0 : itemProps.title\n    }, itemProps === null || itemProps === void 0 ? void 0 : itemProps.stepProps));\n  })));\n\n  var onSubmit = function onSubmit() {\n    var _from$current;\n\n    var from = formArrayRef.current[step];\n    (_from$current = from.current) === null || _from$current === void 0 ? void 0 : _from$current.submit();\n  };\n\n  var next = submitter !== false && /*#__PURE__*/React.createElement(_Button, _extends({\n    key: \"next\",\n    type: \"primary\",\n    loading: loading\n  }, submitter === null || submitter === void 0 ? void 0 : submitter.submitButtonProps, {\n    onClick: function onClick() {\n      var _submitter$onSubmit;\n\n      submitter === null || submitter === void 0 ? void 0 : (_submitter$onSubmit = submitter.onSubmit) === null || _submitter$onSubmit === void 0 ? void 0 : _submitter$onSubmit.call(submitter);\n      onSubmit();\n    }\n  }), intl.getMessage('stepsForm.next', '下一步'));\n  var pre = submitter !== false && /*#__PURE__*/React.createElement(_Button, _extends({\n    key: \"pre\"\n  }, submitter === null || submitter === void 0 ? void 0 : submitter.resetButtonProps, {\n    onClick: function onClick() {\n      var _submitter$onReset; // 没有判断是因为 step<1 这个按钮不显示\n\n\n      setStep(step - 1);\n      submitter === null || submitter === void 0 ? void 0 : (_submitter$onReset = submitter.onReset) === null || _submitter$onReset === void 0 ? void 0 : _submitter$onReset.call(submitter);\n    }\n  }), intl.getMessage('stepsForm.prev', '上一步'));\n  var submit = submitter !== false && /*#__PURE__*/React.createElement(_Button, _extends({\n    key: \"submit\",\n    type: \"primary\",\n    loading: loading\n  }, submitter === null || submitter === void 0 ? void 0 : submitter.submitButtonProps, {\n    onClick: function onClick() {\n      var _submitter$onSubmit2;\n\n      submitter === null || submitter === void 0 ? void 0 : (_submitter$onSubmit2 = submitter.onSubmit) === null || _submitter$onSubmit2 === void 0 ? void 0 : _submitter$onSubmit2.call(submitter);\n      onSubmit();\n    }\n  }), intl.getMessage('stepsForm.submit', '提交'));\n\n  var getActionButton = function getActionButton() {\n    var index = step || 0;\n\n    if (index < 1) {\n      return [next];\n    }\n\n    if (index + 1 === formArray.length) {\n      return [pre, submit];\n    }\n\n    return [pre, next];\n  };\n\n  var renderSubmitter = function renderSubmitter() {\n    var submitterDom = getActionButton();\n\n    if (submitter && submitter.render) {\n      var _formArrayRef$current2;\n\n      var submitterProps = {\n        form: (_formArrayRef$current2 = formArrayRef.current[step]) === null || _formArrayRef$current2 === void 0 ? void 0 : _formArrayRef$current2.current,\n        onSubmit: onSubmit,\n        step: step,\n        onPre: function onPre() {\n          if (step < 1) {\n            return;\n          }\n\n          setStep(step - 1);\n        }\n      };\n      return submitter.render(submitterProps, submitterDom);\n    }\n\n    if (submitter && (submitter === null || submitter === void 0 ? void 0 : submitter.render) === false) {\n      return null;\n    }\n\n    return submitterDom;\n  };\n\n  var formDom = toArray(props.children).map(function (item, index) {\n    var itemProps = item.props;\n    var name = itemProps.name || \"\".concat(index);\n    regForm(name, itemProps);\n    /** 是否是当前的表单 */\n\n    var isShow = step === index;\n    var config = isShow ? {\n      contentRender: stepFormRender,\n      submitter: false\n    } : {};\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classNames(\"\".concat(prefixCls, \"-step\"), _defineProperty({}, \"\".concat(prefixCls, \"-step-active\"), isShow)),\n      key: name\n    }, /*#__PURE__*/React.cloneElement(item, _objectSpread(_objectSpread(_objectSpread(_objectSpread({}, config), formProps), itemProps), {}, {\n      name: name,\n      step: index,\n      key: name\n    })));\n  });\n  var finalStepsDom = props.stepsRender ? props.stepsRender(formArray.map(function (item) {\n    var _formMapRef$current$g;\n\n    return {\n      key: item,\n      title: (_formMapRef$current$g = formMapRef.current.get(item)) === null || _formMapRef$current$g === void 0 ? void 0 : _formMapRef$current$g.title\n    };\n  }), stepsDom) : stepsDom;\n  var submitterDom = renderSubmitter();\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: prefixCls\n  }, /*#__PURE__*/React.createElement(_Form.Provider, rest, /*#__PURE__*/React.createElement(StepsFormProvide.Provider, {\n    value: {\n      loading: loading,\n      setLoading: setLoading,\n      keyArray: formArray,\n      next: function next() {\n        if (step > formArray.length - 2) {\n          return;\n        }\n\n        setStep(step + 1);\n      },\n      formArrayRef: formArrayRef,\n      formMapRef: formMapRef,\n      unRegForm: unRegForm,\n      onFormFinish: onFormFinish\n    }\n  }, stepsFormRender ? stepsFormRender( /*#__PURE__*/React.createElement(React.Fragment, null, finalStepsDom, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-container\"),\n    style: containerStyle\n  }, formDom)), submitterDom) : /*#__PURE__*/React.createElement(React.Fragment, null, finalStepsDom, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-container\"),\n    style: containerStyle\n  }, formDom, /*#__PURE__*/React.createElement(_Space, null, renderSubmitter()))))));\n}\n\nfunction StepsFormWarp(props) {\n  return /*#__PURE__*/React.createElement(ConfigProviderWrap, null, /*#__PURE__*/React.createElement(StepsForm, props));\n}\n\nStepsFormWarp.StepForm = StepForm;\nStepsFormWarp.useForm = _Form.useForm;\nexport default StepsFormWarp;","map":{"version":3,"sources":["C:/web/my-app/node_modules/@ant-design/pro-form/es/layouts/StepsForm/index.js"],"names":["_Form","_Space","_objectSpread","_defineProperty","_Button","_Steps","_extends","_regeneratorRuntime","_toConsumableArray","_asyncToGenerator","_slicedToArray","_objectWithoutProperties","_ConfigProvider","_excluded","React","useRef","useCallback","useEffect","useContext","useImperativeHandle","toArray","useMergedState","classNames","ConfigProviderWrap","useIntl","useMountMergeState","merge","StepForm","StepsFormProvide","createContext","undefined","StepsForm","props","_formArrayRef$current","_useContext","ConfigContext","getPrefixCls","prefixCls","current","onCurrentChange","submitter","stepsFormRender","stepsRender","stepFormRender","stepsProps","onFinish","formProps","containerStyle","formRef","propsFormMapRef","formMapRef","rest","formDataRef","Map","formArrayRef","_useMountMergeState","_useMountMergeState2","formArray","setFormArray","_useMountMergeState3","_useMountMergeState4","loading","setLoading","intl","_useMergedState","value","onChange","_useMergedState2","step","setStep","regForm","name","childrenFormProps","set","unRegForm","delete","Array","from","keys","join","currentFormRef","onFormFinish","_ref","mark","_callee","formData","values","success","wrap","_callee$","_context","prev","next","size","abrupt","apply","concat","sent","forEach","form","_form$current","resetFields","t0","console","log","finish","stop","_x","_x2","arguments","stepsDom","createElement","className","style","maxWidth","Math","min","length","map","item","itemProps","get","Step","key","title","stepProps","onSubmit","_from$current","submit","type","submitButtonProps","onClick","_submitter$onSubmit","call","getMessage","pre","resetButtonProps","_submitter$onReset","onReset","_submitter$onSubmit2","getActionButton","index","renderSubmitter","submitterDom","render","_formArrayRef$current2","submitterProps","onPre","formDom","children","isShow","config","contentRender","cloneElement","finalStepsDom","_formMapRef$current$g","Provider","keyArray","Fragment","StepsFormWarp","useForm"],"mappings":"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","sourcesContent":["import \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/space/style\";\nimport _Space from \"antd/es/space\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/steps/style\";\nimport _Steps from \"antd/es/steps\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nvar _excluded = [\"current\", \"onCurrentChange\", \"submitter\", \"stepsFormRender\", \"stepsRender\", \"stepFormRender\", \"stepsProps\", \"onFinish\", \"formProps\", \"containerStyle\", \"formRef\", \"formMapRef\"];\nimport React, { useRef, useCallback, useEffect, useContext, useImperativeHandle } from 'react';\nimport toArray from \"rc-util/es/Children/toArray\";\nimport useMergedState from \"rc-util/es/hooks/useMergedState\";\nimport classNames from 'classnames';\nimport { ConfigProviderWrap, useIntl } from '@ant-design/pro-provider';\nimport { useMountMergeState, merge } from '@ant-design/pro-utils';\nimport StepForm from './StepForm';\nimport './index.less';\nexport var StepsFormProvide = /*#__PURE__*/React.createContext(undefined);\n\nfunction StepsForm(props) {\n  var _formArrayRef$current;\n\n  var _useContext = useContext(_ConfigProvider.ConfigContext),\n      getPrefixCls = _useContext.getPrefixCls;\n\n  var prefixCls = getPrefixCls('pro-steps-form');\n\n  var current = props.current,\n      onCurrentChange = props.onCurrentChange,\n      submitter = props.submitter,\n      stepsFormRender = props.stepsFormRender,\n      stepsRender = props.stepsRender,\n      stepFormRender = props.stepFormRender,\n      stepsProps = props.stepsProps,\n      onFinish = props.onFinish,\n      formProps = props.formProps,\n      containerStyle = props.containerStyle,\n      formRef = props.formRef,\n      propsFormMapRef = props.formMapRef,\n      rest = _objectWithoutProperties(props, _excluded);\n\n  var formDataRef = useRef(new Map());\n  var formMapRef = useRef(new Map());\n  var formArrayRef = useRef([]);\n\n  var _useMountMergeState = useMountMergeState([]),\n      _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n      formArray = _useMountMergeState2[0],\n      setFormArray = _useMountMergeState2[1];\n\n  var _useMountMergeState3 = useMountMergeState(false),\n      _useMountMergeState4 = _slicedToArray(_useMountMergeState3, 2),\n      loading = _useMountMergeState4[0],\n      setLoading = _useMountMergeState4[1];\n\n  var intl = useIntl();\n  /** 受控的方式来操作表单 */\n\n  var _useMergedState = useMergedState(0, {\n    value: props.current,\n    onChange: props.onCurrentChange\n  }),\n      _useMergedState2 = _slicedToArray(_useMergedState, 2),\n      step = _useMergedState2[0],\n      setStep = _useMergedState2[1];\n  /** 注册一个form进入，方便进行 props 的修改 */\n\n\n  var regForm = useCallback(function (name, childrenFormProps) {\n    formMapRef.current.set(name, childrenFormProps);\n  }, []);\n  /** 接触挂载掉这个 form，同时步数 -1 */\n\n  var unRegForm = useCallback(function (name) {\n    formMapRef.current.delete(name);\n    formDataRef.current.delete(name);\n  }, []);\n  /** Children 计算完成之后，重新生成一下当前的步骤列表 */\n\n  useEffect(function () {\n    setFormArray(Array.from(formMapRef.current.keys())); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [Array.from(formMapRef.current.keys()).join(',')]);\n  var currentFormRef = (_formArrayRef$current = formArrayRef.current[step || 0]) === null || _formArrayRef$current === void 0 ? void 0 : _formArrayRef$current.current;\n  useImperativeHandle(propsFormMapRef, function () {\n    return formArrayRef.current;\n  });\n  useImperativeHandle(formRef, function () {\n    return currentFormRef;\n  });\n  /** ProForm处理了一下 from 的数据，在其中做了一些操作 如果使用 Provider 自带的，自带的数据处理就无法生效了 */\n\n  var onFormFinish = useCallback( /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(name, formData) {\n      var values, success;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              formDataRef.current.set(name, formData); // 如果是最后一步\n\n              if (!(step === formMapRef.current.size - 1 || formMapRef.current.size === 0)) {\n                _context.next = 19;\n                break;\n              }\n\n              if (onFinish) {\n                _context.next = 4;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 4:\n              setLoading(true);\n              values = merge.apply(void 0, [{}].concat(_toConsumableArray(Array.from(formDataRef.current.values()))));\n              _context.prev = 6;\n              _context.next = 9;\n              return onFinish(values);\n\n            case 9:\n              success = _context.sent;\n\n              if (success) {\n                setStep(0);\n                formArrayRef.current.forEach(function (form) {\n                  var _form$current;\n\n                  return (_form$current = form.current) === null || _form$current === void 0 ? void 0 : _form$current.resetFields();\n                });\n              }\n\n              _context.next = 16;\n              break;\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](6);\n              // eslint-disable-next-line no-console\n              console.log(_context.t0);\n\n            case 16:\n              _context.prev = 16;\n              setLoading(false);\n              return _context.finish(16);\n\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[6, 13, 16, 19]]);\n    }));\n\n    return function (_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }(), // eslint-disable-next-line react-hooks/exhaustive-deps\n  [step, formMapRef, onFinish]);\n  var stepsDom = /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-steps-container\"),\n    style: {\n      maxWidth: Math.min(formArray.length * 320, 1160)\n    }\n  }, /*#__PURE__*/React.createElement(_Steps, _extends({}, stepsProps, {\n    current: step,\n    onChange: undefined\n  }), formArray.map(function (item) {\n    var itemProps = formMapRef.current.get(item);\n    return /*#__PURE__*/React.createElement(_Steps.Step, _extends({\n      key: item,\n      title: itemProps === null || itemProps === void 0 ? void 0 : itemProps.title\n    }, itemProps === null || itemProps === void 0 ? void 0 : itemProps.stepProps));\n  })));\n\n  var onSubmit = function onSubmit() {\n    var _from$current;\n\n    var from = formArrayRef.current[step];\n    (_from$current = from.current) === null || _from$current === void 0 ? void 0 : _from$current.submit();\n  };\n\n  var next = submitter !== false && /*#__PURE__*/React.createElement(_Button, _extends({\n    key: \"next\",\n    type: \"primary\",\n    loading: loading\n  }, submitter === null || submitter === void 0 ? void 0 : submitter.submitButtonProps, {\n    onClick: function onClick() {\n      var _submitter$onSubmit;\n\n      submitter === null || submitter === void 0 ? void 0 : (_submitter$onSubmit = submitter.onSubmit) === null || _submitter$onSubmit === void 0 ? void 0 : _submitter$onSubmit.call(submitter);\n      onSubmit();\n    }\n  }), intl.getMessage('stepsForm.next', '下一步'));\n  var pre = submitter !== false && /*#__PURE__*/React.createElement(_Button, _extends({\n    key: \"pre\"\n  }, submitter === null || submitter === void 0 ? void 0 : submitter.resetButtonProps, {\n    onClick: function onClick() {\n      var _submitter$onReset;\n\n      // 没有判断是因为 step<1 这个按钮不显示\n      setStep(step - 1);\n      submitter === null || submitter === void 0 ? void 0 : (_submitter$onReset = submitter.onReset) === null || _submitter$onReset === void 0 ? void 0 : _submitter$onReset.call(submitter);\n    }\n  }), intl.getMessage('stepsForm.prev', '上一步'));\n  var submit = submitter !== false && /*#__PURE__*/React.createElement(_Button, _extends({\n    key: \"submit\",\n    type: \"primary\",\n    loading: loading\n  }, submitter === null || submitter === void 0 ? void 0 : submitter.submitButtonProps, {\n    onClick: function onClick() {\n      var _submitter$onSubmit2;\n\n      submitter === null || submitter === void 0 ? void 0 : (_submitter$onSubmit2 = submitter.onSubmit) === null || _submitter$onSubmit2 === void 0 ? void 0 : _submitter$onSubmit2.call(submitter);\n      onSubmit();\n    }\n  }), intl.getMessage('stepsForm.submit', '提交'));\n\n  var getActionButton = function getActionButton() {\n    var index = step || 0;\n\n    if (index < 1) {\n      return [next];\n    }\n\n    if (index + 1 === formArray.length) {\n      return [pre, submit];\n    }\n\n    return [pre, next];\n  };\n\n  var renderSubmitter = function renderSubmitter() {\n    var submitterDom = getActionButton();\n\n    if (submitter && submitter.render) {\n      var _formArrayRef$current2;\n\n      var submitterProps = {\n        form: (_formArrayRef$current2 = formArrayRef.current[step]) === null || _formArrayRef$current2 === void 0 ? void 0 : _formArrayRef$current2.current,\n        onSubmit: onSubmit,\n        step: step,\n        onPre: function onPre() {\n          if (step < 1) {\n            return;\n          }\n\n          setStep(step - 1);\n        }\n      };\n      return submitter.render(submitterProps, submitterDom);\n    }\n\n    if (submitter && (submitter === null || submitter === void 0 ? void 0 : submitter.render) === false) {\n      return null;\n    }\n\n    return submitterDom;\n  };\n\n  var formDom = toArray(props.children).map(function (item, index) {\n    var itemProps = item.props;\n    var name = itemProps.name || \"\".concat(index);\n    regForm(name, itemProps);\n    /** 是否是当前的表单 */\n\n    var isShow = step === index;\n    var config = isShow ? {\n      contentRender: stepFormRender,\n      submitter: false\n    } : {};\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classNames(\"\".concat(prefixCls, \"-step\"), _defineProperty({}, \"\".concat(prefixCls, \"-step-active\"), isShow)),\n      key: name\n    }, /*#__PURE__*/React.cloneElement(item, _objectSpread(_objectSpread(_objectSpread(_objectSpread({}, config), formProps), itemProps), {}, {\n      name: name,\n      step: index,\n      key: name\n    })));\n  });\n  var finalStepsDom = props.stepsRender ? props.stepsRender(formArray.map(function (item) {\n    var _formMapRef$current$g;\n\n    return {\n      key: item,\n      title: (_formMapRef$current$g = formMapRef.current.get(item)) === null || _formMapRef$current$g === void 0 ? void 0 : _formMapRef$current$g.title\n    };\n  }), stepsDom) : stepsDom;\n  var submitterDom = renderSubmitter();\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: prefixCls\n  }, /*#__PURE__*/React.createElement(_Form.Provider, rest, /*#__PURE__*/React.createElement(StepsFormProvide.Provider, {\n    value: {\n      loading: loading,\n      setLoading: setLoading,\n      keyArray: formArray,\n      next: function next() {\n        if (step > formArray.length - 2) {\n          return;\n        }\n\n        setStep(step + 1);\n      },\n      formArrayRef: formArrayRef,\n      formMapRef: formMapRef,\n      unRegForm: unRegForm,\n      onFormFinish: onFormFinish\n    }\n  }, stepsFormRender ? stepsFormRender( /*#__PURE__*/React.createElement(React.Fragment, null, finalStepsDom, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-container\"),\n    style: containerStyle\n  }, formDom)), submitterDom) : /*#__PURE__*/React.createElement(React.Fragment, null, finalStepsDom, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-container\"),\n    style: containerStyle\n  }, formDom, /*#__PURE__*/React.createElement(_Space, null, renderSubmitter()))))));\n}\n\nfunction StepsFormWarp(props) {\n  return /*#__PURE__*/React.createElement(ConfigProviderWrap, null, /*#__PURE__*/React.createElement(StepsForm, props));\n}\n\nStepsFormWarp.StepForm = StepForm;\nStepsFormWarp.useForm = _Form.useForm;\nexport default StepsFormWarp;"]},"metadata":{},"sourceType":"module"}