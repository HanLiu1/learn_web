{"ast":null,"code":"import \"antd/es/spin/style\";\nimport _Spin from \"antd/es/spin\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport \"antd/es/space/style\";\nimport _Space from \"antd/es/space\";\nvar _excluded = [\"value\", \"text\"],\n    _excluded2 = [\"mode\", \"valueEnum\", \"render\", \"renderFormItem\", \"request\", \"fieldProps\", \"plain\", \"children\", \"light\", \"proFieldKey\", \"params\", \"label\", \"bordered\", \"id\"];\nimport { useMemo } from 'react';\nimport React, { useState, useImperativeHandle, useRef, useContext, useCallback, useEffect } from 'react';\nimport { useDebounceFn, useDeepCompareEffect, useMountMergeState } from '@ant-design/pro-utils';\nimport useSWR, { mutate } from 'swr';\nimport { useIntl } from '@ant-design/pro-provider';\nimport LightSelect from './LightSelect';\nimport SearchSelect from './SearchSelect';\nimport TableStatus, { ProFieldBadgeColor } from '../Status';\nimport './index.less';\nvar testId = 0;\nexport var ObjToMap = function ObjToMap(value) {\n  if (getType(value) === 'map') {\n    return value;\n  }\n\n  return new Map(Object.entries(value || {}));\n};\n/**\n * 转化 text 和 valueEnum 通过 type 来添加 Status\n *\n * @param text\n * @param valueEnum\n * @param pure 纯净模式，不增加 status\n */\n\nexport var proFieldParsingText = function proFieldParsingText(text, valueEnumParams) {\n  if (Array.isArray(text)) {\n    return /*#__PURE__*/React.createElement(_Space, null, text.map(function (value) {\n      return (\n        /*#__PURE__*/\n        // @ts-ignore\n        React.createElement(React.Fragment, {\n          key: (value === null || value === void 0 ? void 0 : value.value) || value\n        }, proFieldParsingText(value, valueEnumParams))\n      );\n    }));\n  }\n\n  var valueEnum = ObjToMap(valueEnumParams);\n\n  if (!valueEnum.has(text) && !valueEnum.has(\"\".concat(text))) {\n    // @ts-ignore\n    return (text === null || text === void 0 ? void 0 : text.label) || text;\n  }\n\n  var domText = valueEnum.get(text) || valueEnum.get(\"\".concat(text));\n\n  if (!domText) {\n    // @ts-ignore\n    return (text === null || text === void 0 ? void 0 : text.label) || text;\n  }\n\n  var status = domText.status,\n      color = domText.color;\n  var Status = TableStatus[status || 'Init']; // 如果类型存在优先使用类型\n\n  if (Status) {\n    return /*#__PURE__*/React.createElement(Status, null, domText.text);\n  } // 如果不存在使用颜色\n\n\n  if (color) {\n    return /*#__PURE__*/React.createElement(ProFieldBadgeColor, {\n      color: color\n    }, domText.text);\n  } // 什么都没有使用 text\n\n\n  return domText.text || domText;\n};\n\nvar Highlight = function Highlight(_ref) {\n  var label = _ref.label,\n      words = _ref.words;\n  var REG_LIST = '.^$*+-?()[]{}\\\\|';\n\n  var _useContext = useContext(_ConfigProvider.ConfigContext),\n      getPrefixCls = _useContext.getPrefixCls;\n\n  var lightCls = getPrefixCls('pro-select-item-option-content-light');\n  var optionCls = getPrefixCls('pro-select-item-option-content');\n  var reg = new RegExp(words.map(function (word) {\n    return word.split('').map(function (w) {\n      return REG_LIST.includes(w) ? \"\\\\\".concat(w) : w;\n    }).join('');\n  }).join('|'), 'gi');\n  var token = label.replace(reg, '#@$&#');\n  var elements = token.split('#').map(function (x) {\n    return x[0] === '@' ? /*#__PURE__*/React.createElement('span', {\n      className: lightCls\n    }, x.slice(1)) : x;\n  });\n  return /*#__PURE__*/React.createElement.apply(React, ['div', {\n    className: optionCls\n  }].concat(_toConsumableArray(elements)));\n};\n/**\n * 获取类型的 type\n *\n * @param obj\n */\n\n\nfunction getType(obj) {\n  // @ts-ignore\n  var type = Object.prototype.toString.call(obj).match(/^\\[object (.*)\\]$/)[1].toLowerCase();\n  if (type === 'string' && _typeof(obj) === 'object') return 'object'; // Let \"new String('')\" return 'object'\n\n  if (obj === null) return 'null'; // PhantomJS has type \"DOMWindow\" for null\n\n  if (obj === undefined) return 'undefined'; // PhantomJS has type \"DOMWindow\" for undefined\n\n  return type;\n}\n/**\n * 递归筛选 item\n *\n * @param item\n * @param keyWords\n * @returns\n */\n\n\nfunction filerByItem(item, keyWords) {\n  var _item$label, _item$value;\n\n  if (!keyWords) return true;\n\n  if ((item === null || item === void 0 ? void 0 : (_item$label = item.label) === null || _item$label === void 0 ? void 0 : _item$label.toString().toLowerCase().includes(keyWords.toLowerCase())) || (item === null || item === void 0 ? void 0 : (_item$value = item.value) === null || _item$value === void 0 ? void 0 : _item$value.toString().toLowerCase().includes(keyWords.toLowerCase()))) {\n    return true;\n  }\n\n  if (item.optionType === 'optGroup' && (item.children || item.options)) {\n    var findItem = [].concat(_toConsumableArray(item.children || []), [item.options || []]).find(function (mapItem) {\n      return filerByItem(mapItem, keyWords);\n    });\n    if (findItem) return true;\n  }\n\n  return false;\n}\n/**\n * 把 value 的枚举转化为数组\n *\n * @param valueEnum\n */\n\n\nexport var proFieldParsingValueEnumToArray = function proFieldParsingValueEnumToArray(valueEnumParams) {\n  var enumArray = [];\n  var valueEnum = ObjToMap(valueEnumParams);\n  valueEnum.forEach(function (_, key) {\n    var value = valueEnum.get(key) || valueEnum.get(\"\".concat(key));\n\n    if (!value) {\n      return;\n    }\n\n    if (_typeof(value) === 'object' && (value === null || value === void 0 ? void 0 : value.text)) {\n      enumArray.push({\n        text: value === null || value === void 0 ? void 0 : value.text,\n        value: key,\n        disabled: value.disabled\n      });\n      return;\n    }\n\n    enumArray.push({\n      text: value,\n      value: key\n    });\n  });\n  return enumArray;\n};\nexport var useFieldFetchData = function useFieldFetchData(props) {\n  var _props$fieldProps, _props$debounceTime, _props$fieldProps5;\n\n  var _useState = useState(undefined),\n      _useState2 = _slicedToArray(_useState, 2),\n      keyWords = _useState2[0],\n      setKeyWords = _useState2[1];\n  /** Key 是用来缓存请求的，如果不在是有问题 */\n\n\n  var _useState3 = useState(function () {\n    if (props.proFieldKey) {\n      return props.proFieldKey.toString();\n    }\n\n    if (props.request) {\n      testId += 1;\n      return testId.toString();\n    }\n\n    return 'no-fetch';\n  }),\n      _useState4 = _slicedToArray(_useState3, 1),\n      cacheKey = _useState4[0];\n\n  var proFieldKeyRef = useRef(cacheKey);\n  var getOptionsFormValueEnum = useCallback(function (valueEnum) {\n    return proFieldParsingValueEnumToArray(ObjToMap(valueEnum)).map(function (_ref2) {\n      var value = _ref2.value,\n          text = _ref2.text,\n          rest = _objectWithoutProperties(_ref2, _excluded);\n\n      return _objectSpread({\n        label: text,\n        value: value,\n        key: value\n      }, rest);\n    });\n  }, []);\n\n  var _useMountMergeState = useMountMergeState(function () {\n    if (props.valueEnum) {\n      return getOptionsFormValueEnum(props.valueEnum);\n    }\n\n    return [];\n  }, {\n    value: (_props$fieldProps = props.fieldProps) === null || _props$fieldProps === void 0 ? void 0 : _props$fieldProps.options\n  }),\n      _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n      options = _useMountMergeState2[0],\n      setOptions = _useMountMergeState2[1];\n\n  useDeepCompareEffect(function () {\n    var _props$fieldProps2; // 优先使用 fieldProps?.options\n\n\n    if (!props.valueEnum || ((_props$fieldProps2 = props.fieldProps) === null || _props$fieldProps2 === void 0 ? void 0 : _props$fieldProps2.options)) return;\n    setOptions(getOptionsFormValueEnum(props.valueEnum));\n  }, [props.valueEnum]);\n\n  var _useMountMergeState3 = useMountMergeState(false),\n      _useMountMergeState4 = _slicedToArray(_useMountMergeState3, 2),\n      loading = _useMountMergeState4[0],\n      setLoading = _useMountMergeState4[1];\n\n  var _useDebounceFn = useDebounceFn( /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(params) {\n      var loadData;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (props.request) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\", []);\n\n            case 2:\n              setLoading(true);\n              _context.next = 5;\n              return props.request(params, props);\n\n            case 5:\n              loadData = _context.sent;\n              setLoading(false);\n              return _context.abrupt(\"return\", loadData);\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }(), [], (_props$debounceTime = props.debounceTime) !== null && _props$debounceTime !== void 0 ? _props$debounceTime : 10),\n      fetchData = _useDebounceFn.run;\n\n  var key = useMemo(function () {\n    if (!props.request) {\n      return 'no-fetch';\n    }\n\n    return proFieldKeyRef.current;\n  }, [props.request]);\n\n  var _useSWR = useSWR([key, props.params, keyWords], function (_, params, kw) {\n    return fetchData(_objectSpread(_objectSpread({}, params), {}, {\n      keyWords: kw\n    }));\n  }, {\n    revalidateOnFocus: false,\n    shouldRetryOnError: false,\n    revalidateOnReconnect: false\n  }),\n      data = _useSWR.data,\n      setLocaleData = _useSWR.mutate;\n\n  var resOptions = useMemo(function () {\n    var _props$fieldProps3, _props$fieldProps4;\n\n    var opt = options === null || options === void 0 ? void 0 : options.map(function (item) {\n      if (typeof item === 'string') {\n        return {\n          label: item,\n          value: item\n        };\n      }\n\n      if ((item === null || item === void 0 ? void 0 : item.optionType) === 'optGroup' && (item.children || item.options)) {\n        var childrenOptions = [].concat(_toConsumableArray(item.children || []), _toConsumableArray(item.options || [])).filter(function (mapItem) {\n          return filerByItem(mapItem, keyWords);\n        });\n        return _objectSpread(_objectSpread({}, item), {}, {\n          children: childrenOptions,\n          options: childrenOptions\n        });\n      }\n\n      return item;\n    }); // filterOption 为 true 时 filter数据, filterOption 默认为true\n\n    if (((_props$fieldProps3 = props.fieldProps) === null || _props$fieldProps3 === void 0 ? void 0 : _props$fieldProps3.filterOption) === true || ((_props$fieldProps4 = props.fieldProps) === null || _props$fieldProps4 === void 0 ? void 0 : _props$fieldProps4.filterOption) === undefined) {\n      return opt === null || opt === void 0 ? void 0 : opt.filter(function (item) {\n        if (!item) return false;\n        if (!keyWords) return true;\n        return filerByItem(item, keyWords);\n      });\n    }\n\n    return opt;\n  }, [options, keyWords, (_props$fieldProps5 = props.fieldProps) === null || _props$fieldProps5 === void 0 ? void 0 : _props$fieldProps5.filterOption]);\n  return [loading, props.request ? data : resOptions, function (fetchKeyWords) {\n    setKeyWords(fetchKeyWords);\n    mutate(key);\n  }, function () {\n    setKeyWords(undefined);\n    setLocaleData([], false);\n  }];\n};\n/**\n * 可以根据 valueEnum 来进行类型的设置\n *\n * @param\n */\n\nvar FieldSelect = function FieldSelect(props, ref) {\n  var mode = props.mode,\n      valueEnum = props.valueEnum,\n      render = props.render,\n      renderFormItem = props.renderFormItem,\n      request = props.request,\n      fieldProps = props.fieldProps,\n      plain = props.plain,\n      children = props.children,\n      light = props.light,\n      proFieldKey = props.proFieldKey,\n      params = props.params,\n      label = props.label,\n      bordered = props.bordered,\n      id = props.id,\n      rest = _objectWithoutProperties(props, _excluded2);\n\n  var inputRef = useRef();\n  var intl = useIntl();\n  var keyWordsRef = useRef('');\n  useEffect(function () {\n    testId += 1;\n  }, []);\n  useEffect(function () {\n    keyWordsRef.current = fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.searchValue;\n  }, [fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.searchValue]);\n\n  var _useFieldFetchData = useFieldFetchData(props),\n      _useFieldFetchData2 = _slicedToArray(_useFieldFetchData, 4),\n      loading = _useFieldFetchData2[0],\n      options = _useFieldFetchData2[1],\n      _fetchData = _useFieldFetchData2[2],\n      resetData = _useFieldFetchData2[3];\n\n  var size = useContext(_ConfigProvider.SizeContext);\n  useImperativeHandle(ref, function () {\n    return _objectSpread(_objectSpread({}, inputRef.current || {}), {}, {\n      fetchData: function fetchData() {\n        return _fetchData();\n      }\n    });\n  });\n\n  if (mode === 'read') {\n    var _rest$text;\n\n    var optionsValueEnum = (options === null || options === void 0 ? void 0 : options.length) ? options === null || options === void 0 ? void 0 : options.reduce(function (pre, cur) {\n      return _objectSpread(_objectSpread({}, pre), {}, _defineProperty({}, cur.value, cur.label));\n    }, {}) : undefined; // 如果有 label 直接就用 label\n    // @ts-ignore\n\n    if ((_rest$text = rest.text) === null || _rest$text === void 0 ? void 0 : _rest$text.label) {\n      var _rest$text2; // @ts-ignore\n\n\n      return (_rest$text2 = rest.text) === null || _rest$text2 === void 0 ? void 0 : _rest$text2.label;\n    }\n\n    var dom = /*#__PURE__*/React.createElement(React.Fragment, null, proFieldParsingText(rest.text, ObjToMap(valueEnum || optionsValueEnum)));\n\n    if (render) {\n      return render(rest.text, _objectSpread({\n        mode: mode\n      }, fieldProps), dom) || null;\n    }\n\n    return dom;\n  }\n\n  if (mode === 'edit' || mode === 'update') {\n    var renderDom = function renderDom() {\n      if (light) {\n        return /*#__PURE__*/React.createElement(LightSelect, _extends({\n          bordered: bordered,\n          id: id,\n          loading: loading,\n          ref: inputRef,\n          allowClear: true,\n          size: size,\n          options: options,\n          label: label,\n          placeholder: intl.getMessage('tableForm.selectPlaceholder', '请选择')\n        }, fieldProps));\n      }\n\n      return /*#__PURE__*/React.createElement(SearchSelect, _extends({\n        key: \"SearchSelect\",\n        style: {\n          minWidth: 100\n        },\n        bordered: bordered,\n        id: id,\n        loading: loading,\n        ref: inputRef,\n        allowClear: true,\n        notFoundContent: loading ? /*#__PURE__*/React.createElement(_Spin, {\n          size: \"small\"\n        }) : fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.notFoundContent,\n        fetchData: function fetchData(keyWord) {\n          keyWordsRef.current = keyWord;\n\n          _fetchData(keyWord);\n        },\n        resetData: resetData,\n        optionItemRender: function optionItemRender(item) {\n          if (typeof item.label === 'string' && keyWordsRef.current) {\n            return /*#__PURE__*/React.createElement(Highlight, {\n              label: item.label,\n              words: [keyWordsRef.current]\n            });\n          }\n\n          return item.label;\n        },\n        placeholder: intl.getMessage('tableForm.selectPlaceholder', '请选择'),\n        label: label\n      }, fieldProps, {\n        options: options\n      }));\n    };\n\n    var _dom = renderDom();\n\n    if (renderFormItem) {\n      return renderFormItem(rest.text, _objectSpread(_objectSpread({\n        mode: mode\n      }, fieldProps), {}, {\n        options: options\n      }), _dom) || null;\n    }\n\n    return _dom;\n  }\n\n  return null;\n};\n\nexport default /*#__PURE__*/React.forwardRef(FieldSelect);","map":{"version":3,"sources":["C:/web/my-app/node_modules/@ant-design/pro-field/es/components/Select/index.js"],"names":["_Spin","_extends","_defineProperty","_regeneratorRuntime","_asyncToGenerator","_objectSpread","_objectWithoutProperties","_slicedToArray","_typeof","_toConsumableArray","_ConfigProvider","_Space","_excluded","_excluded2","useMemo","React","useState","useImperativeHandle","useRef","useContext","useCallback","useEffect","useDebounceFn","useDeepCompareEffect","useMountMergeState","useSWR","mutate","useIntl","LightSelect","SearchSelect","TableStatus","ProFieldBadgeColor","testId","ObjToMap","value","getType","Map","Object","entries","proFieldParsingText","text","valueEnumParams","Array","isArray","createElement","map","Fragment","key","valueEnum","has","concat","label","domText","get","status","color","Status","Highlight","_ref","words","REG_LIST","_useContext","ConfigContext","getPrefixCls","lightCls","optionCls","reg","RegExp","word","split","w","includes","join","token","replace","elements","x","className","slice","apply","obj","type","prototype","toString","call","match","toLowerCase","undefined","filerByItem","item","keyWords","_item$label","_item$value","optionType","children","options","findItem","find","mapItem","proFieldParsingValueEnumToArray","enumArray","forEach","_","push","disabled","useFieldFetchData","props","_props$fieldProps","_props$debounceTime","_props$fieldProps5","_useState","_useState2","setKeyWords","_useState3","proFieldKey","request","_useState4","cacheKey","proFieldKeyRef","getOptionsFormValueEnum","_ref2","rest","_useMountMergeState","fieldProps","_useMountMergeState2","setOptions","_props$fieldProps2","_useMountMergeState3","_useMountMergeState4","loading","setLoading","_useDebounceFn","_ref3","mark","_callee","params","loadData","wrap","_callee$","_context","prev","next","abrupt","sent","stop","_x","arguments","debounceTime","fetchData","run","current","_useSWR","kw","revalidateOnFocus","shouldRetryOnError","revalidateOnReconnect","data","setLocaleData","resOptions","_props$fieldProps3","_props$fieldProps4","opt","childrenOptions","filter","filterOption","fetchKeyWords","FieldSelect","ref","mode","render","renderFormItem","plain","light","bordered","id","inputRef","intl","keyWordsRef","searchValue","_useFieldFetchData","_useFieldFetchData2","_fetchData","resetData","size","SizeContext","_rest$text","optionsValueEnum","length","reduce","pre","cur","_rest$text2","dom","renderDom","allowClear","placeholder","getMessage","style","minWidth","notFoundContent","keyWord","optionItemRender","_dom","forwardRef"],"mappings":"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","sourcesContent":["import \"antd/es/spin/style\";\nimport _Spin from \"antd/es/spin\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport \"antd/es/config-provider/style\";\nimport _ConfigProvider from \"antd/es/config-provider\";\nimport \"antd/es/space/style\";\nimport _Space from \"antd/es/space\";\nvar _excluded = [\"value\", \"text\"],\n    _excluded2 = [\"mode\", \"valueEnum\", \"render\", \"renderFormItem\", \"request\", \"fieldProps\", \"plain\", \"children\", \"light\", \"proFieldKey\", \"params\", \"label\", \"bordered\", \"id\"];\nimport { useMemo } from 'react';\nimport React, { useState, useImperativeHandle, useRef, useContext, useCallback, useEffect } from 'react';\nimport { useDebounceFn, useDeepCompareEffect, useMountMergeState } from '@ant-design/pro-utils';\nimport useSWR, { mutate } from 'swr';\nimport { useIntl } from '@ant-design/pro-provider';\nimport LightSelect from './LightSelect';\nimport SearchSelect from './SearchSelect';\nimport TableStatus, { ProFieldBadgeColor } from '../Status';\nimport './index.less';\nvar testId = 0;\nexport var ObjToMap = function ObjToMap(value) {\n  if (getType(value) === 'map') {\n    return value;\n  }\n\n  return new Map(Object.entries(value || {}));\n};\n/**\n * 转化 text 和 valueEnum 通过 type 来添加 Status\n *\n * @param text\n * @param valueEnum\n * @param pure 纯净模式，不增加 status\n */\n\nexport var proFieldParsingText = function proFieldParsingText(text, valueEnumParams) {\n  if (Array.isArray(text)) {\n    return /*#__PURE__*/React.createElement(_Space, null, text.map(function (value) {\n      return (\n        /*#__PURE__*/\n        // @ts-ignore\n        React.createElement(React.Fragment, {\n          key: (value === null || value === void 0 ? void 0 : value.value) || value\n        }, proFieldParsingText(value, valueEnumParams))\n      );\n    }));\n  }\n\n  var valueEnum = ObjToMap(valueEnumParams);\n\n  if (!valueEnum.has(text) && !valueEnum.has(\"\".concat(text))) {\n    // @ts-ignore\n    return (text === null || text === void 0 ? void 0 : text.label) || text;\n  }\n\n  var domText = valueEnum.get(text) || valueEnum.get(\"\".concat(text));\n\n  if (!domText) {\n    // @ts-ignore\n    return (text === null || text === void 0 ? void 0 : text.label) || text;\n  }\n\n  var status = domText.status,\n      color = domText.color;\n  var Status = TableStatus[status || 'Init']; // 如果类型存在优先使用类型\n\n  if (Status) {\n    return /*#__PURE__*/React.createElement(Status, null, domText.text);\n  } // 如果不存在使用颜色\n\n\n  if (color) {\n    return /*#__PURE__*/React.createElement(ProFieldBadgeColor, {\n      color: color\n    }, domText.text);\n  } // 什么都没有使用 text\n\n\n  return domText.text || domText;\n};\n\nvar Highlight = function Highlight(_ref) {\n  var label = _ref.label,\n      words = _ref.words;\n  var REG_LIST = '.^$*+-?()[]{}\\\\|';\n\n  var _useContext = useContext(_ConfigProvider.ConfigContext),\n      getPrefixCls = _useContext.getPrefixCls;\n\n  var lightCls = getPrefixCls('pro-select-item-option-content-light');\n  var optionCls = getPrefixCls('pro-select-item-option-content');\n  var reg = new RegExp(words.map(function (word) {\n    return word.split('').map(function (w) {\n      return REG_LIST.includes(w) ? \"\\\\\".concat(w) : w;\n    }).join('');\n  }).join('|'), 'gi');\n  var token = label.replace(reg, '#@$&#');\n  var elements = token.split('#').map(function (x) {\n    return x[0] === '@' ? /*#__PURE__*/React.createElement('span', {\n      className: lightCls\n    }, x.slice(1)) : x;\n  });\n  return /*#__PURE__*/React.createElement.apply(React, ['div', {\n    className: optionCls\n  }].concat(_toConsumableArray(elements)));\n};\n/**\n * 获取类型的 type\n *\n * @param obj\n */\n\n\nfunction getType(obj) {\n  // @ts-ignore\n  var type = Object.prototype.toString.call(obj).match(/^\\[object (.*)\\]$/)[1].toLowerCase();\n  if (type === 'string' && _typeof(obj) === 'object') return 'object'; // Let \"new String('')\" return 'object'\n\n  if (obj === null) return 'null'; // PhantomJS has type \"DOMWindow\" for null\n\n  if (obj === undefined) return 'undefined'; // PhantomJS has type \"DOMWindow\" for undefined\n\n  return type;\n}\n/**\n * 递归筛选 item\n *\n * @param item\n * @param keyWords\n * @returns\n */\n\n\nfunction filerByItem(item, keyWords) {\n  var _item$label, _item$value;\n\n  if (!keyWords) return true;\n\n  if ((item === null || item === void 0 ? void 0 : (_item$label = item.label) === null || _item$label === void 0 ? void 0 : _item$label.toString().toLowerCase().includes(keyWords.toLowerCase())) || (item === null || item === void 0 ? void 0 : (_item$value = item.value) === null || _item$value === void 0 ? void 0 : _item$value.toString().toLowerCase().includes(keyWords.toLowerCase()))) {\n    return true;\n  }\n\n  if (item.optionType === 'optGroup' && (item.children || item.options)) {\n    var findItem = [].concat(_toConsumableArray(item.children || []), [item.options || []]).find(function (mapItem) {\n      return filerByItem(mapItem, keyWords);\n    });\n    if (findItem) return true;\n  }\n\n  return false;\n}\n/**\n * 把 value 的枚举转化为数组\n *\n * @param valueEnum\n */\n\n\nexport var proFieldParsingValueEnumToArray = function proFieldParsingValueEnumToArray(valueEnumParams) {\n  var enumArray = [];\n  var valueEnum = ObjToMap(valueEnumParams);\n  valueEnum.forEach(function (_, key) {\n    var value = valueEnum.get(key) || valueEnum.get(\"\".concat(key));\n\n    if (!value) {\n      return;\n    }\n\n    if (_typeof(value) === 'object' && (value === null || value === void 0 ? void 0 : value.text)) {\n      enumArray.push({\n        text: value === null || value === void 0 ? void 0 : value.text,\n        value: key,\n        disabled: value.disabled\n      });\n      return;\n    }\n\n    enumArray.push({\n      text: value,\n      value: key\n    });\n  });\n  return enumArray;\n};\nexport var useFieldFetchData = function useFieldFetchData(props) {\n  var _props$fieldProps, _props$debounceTime, _props$fieldProps5;\n\n  var _useState = useState(undefined),\n      _useState2 = _slicedToArray(_useState, 2),\n      keyWords = _useState2[0],\n      setKeyWords = _useState2[1];\n  /** Key 是用来缓存请求的，如果不在是有问题 */\n\n\n  var _useState3 = useState(function () {\n    if (props.proFieldKey) {\n      return props.proFieldKey.toString();\n    }\n\n    if (props.request) {\n      testId += 1;\n      return testId.toString();\n    }\n\n    return 'no-fetch';\n  }),\n      _useState4 = _slicedToArray(_useState3, 1),\n      cacheKey = _useState4[0];\n\n  var proFieldKeyRef = useRef(cacheKey);\n  var getOptionsFormValueEnum = useCallback(function (valueEnum) {\n    return proFieldParsingValueEnumToArray(ObjToMap(valueEnum)).map(function (_ref2) {\n      var value = _ref2.value,\n          text = _ref2.text,\n          rest = _objectWithoutProperties(_ref2, _excluded);\n\n      return _objectSpread({\n        label: text,\n        value: value,\n        key: value\n      }, rest);\n    });\n  }, []);\n\n  var _useMountMergeState = useMountMergeState(function () {\n    if (props.valueEnum) {\n      return getOptionsFormValueEnum(props.valueEnum);\n    }\n\n    return [];\n  }, {\n    value: (_props$fieldProps = props.fieldProps) === null || _props$fieldProps === void 0 ? void 0 : _props$fieldProps.options\n  }),\n      _useMountMergeState2 = _slicedToArray(_useMountMergeState, 2),\n      options = _useMountMergeState2[0],\n      setOptions = _useMountMergeState2[1];\n\n  useDeepCompareEffect(function () {\n    var _props$fieldProps2;\n\n    // 优先使用 fieldProps?.options\n    if (!props.valueEnum || ((_props$fieldProps2 = props.fieldProps) === null || _props$fieldProps2 === void 0 ? void 0 : _props$fieldProps2.options)) return;\n    setOptions(getOptionsFormValueEnum(props.valueEnum));\n  }, [props.valueEnum]);\n\n  var _useMountMergeState3 = useMountMergeState(false),\n      _useMountMergeState4 = _slicedToArray(_useMountMergeState3, 2),\n      loading = _useMountMergeState4[0],\n      setLoading = _useMountMergeState4[1];\n\n  var _useDebounceFn = useDebounceFn( /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(params) {\n      var loadData;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (props.request) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\", []);\n\n            case 2:\n              setLoading(true);\n              _context.next = 5;\n              return props.request(params, props);\n\n            case 5:\n              loadData = _context.sent;\n              setLoading(false);\n              return _context.abrupt(\"return\", loadData);\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }(), [], (_props$debounceTime = props.debounceTime) !== null && _props$debounceTime !== void 0 ? _props$debounceTime : 10),\n      fetchData = _useDebounceFn.run;\n\n  var key = useMemo(function () {\n    if (!props.request) {\n      return 'no-fetch';\n    }\n\n    return proFieldKeyRef.current;\n  }, [props.request]);\n\n  var _useSWR = useSWR([key, props.params, keyWords], function (_, params, kw) {\n    return fetchData(_objectSpread(_objectSpread({}, params), {}, {\n      keyWords: kw\n    }));\n  }, {\n    revalidateOnFocus: false,\n    shouldRetryOnError: false,\n    revalidateOnReconnect: false\n  }),\n      data = _useSWR.data,\n      setLocaleData = _useSWR.mutate;\n\n  var resOptions = useMemo(function () {\n    var _props$fieldProps3, _props$fieldProps4;\n\n    var opt = options === null || options === void 0 ? void 0 : options.map(function (item) {\n      if (typeof item === 'string') {\n        return {\n          label: item,\n          value: item\n        };\n      }\n\n      if ((item === null || item === void 0 ? void 0 : item.optionType) === 'optGroup' && (item.children || item.options)) {\n        var childrenOptions = [].concat(_toConsumableArray(item.children || []), _toConsumableArray(item.options || [])).filter(function (mapItem) {\n          return filerByItem(mapItem, keyWords);\n        });\n        return _objectSpread(_objectSpread({}, item), {}, {\n          children: childrenOptions,\n          options: childrenOptions\n        });\n      }\n\n      return item;\n    }); // filterOption 为 true 时 filter数据, filterOption 默认为true\n\n    if (((_props$fieldProps3 = props.fieldProps) === null || _props$fieldProps3 === void 0 ? void 0 : _props$fieldProps3.filterOption) === true || ((_props$fieldProps4 = props.fieldProps) === null || _props$fieldProps4 === void 0 ? void 0 : _props$fieldProps4.filterOption) === undefined) {\n      return opt === null || opt === void 0 ? void 0 : opt.filter(function (item) {\n        if (!item) return false;\n        if (!keyWords) return true;\n        return filerByItem(item, keyWords);\n      });\n    }\n\n    return opt;\n  }, [options, keyWords, (_props$fieldProps5 = props.fieldProps) === null || _props$fieldProps5 === void 0 ? void 0 : _props$fieldProps5.filterOption]);\n  return [loading, props.request ? data : resOptions, function (fetchKeyWords) {\n    setKeyWords(fetchKeyWords);\n    mutate(key);\n  }, function () {\n    setKeyWords(undefined);\n    setLocaleData([], false);\n  }];\n};\n/**\n * 可以根据 valueEnum 来进行类型的设置\n *\n * @param\n */\n\nvar FieldSelect = function FieldSelect(props, ref) {\n  var mode = props.mode,\n      valueEnum = props.valueEnum,\n      render = props.render,\n      renderFormItem = props.renderFormItem,\n      request = props.request,\n      fieldProps = props.fieldProps,\n      plain = props.plain,\n      children = props.children,\n      light = props.light,\n      proFieldKey = props.proFieldKey,\n      params = props.params,\n      label = props.label,\n      bordered = props.bordered,\n      id = props.id,\n      rest = _objectWithoutProperties(props, _excluded2);\n\n  var inputRef = useRef();\n  var intl = useIntl();\n  var keyWordsRef = useRef('');\n  useEffect(function () {\n    testId += 1;\n  }, []);\n  useEffect(function () {\n    keyWordsRef.current = fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.searchValue;\n  }, [fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.searchValue]);\n\n  var _useFieldFetchData = useFieldFetchData(props),\n      _useFieldFetchData2 = _slicedToArray(_useFieldFetchData, 4),\n      loading = _useFieldFetchData2[0],\n      options = _useFieldFetchData2[1],\n      _fetchData = _useFieldFetchData2[2],\n      resetData = _useFieldFetchData2[3];\n\n  var size = useContext(_ConfigProvider.SizeContext);\n  useImperativeHandle(ref, function () {\n    return _objectSpread(_objectSpread({}, inputRef.current || {}), {}, {\n      fetchData: function fetchData() {\n        return _fetchData();\n      }\n    });\n  });\n\n  if (mode === 'read') {\n    var _rest$text;\n\n    var optionsValueEnum = (options === null || options === void 0 ? void 0 : options.length) ? options === null || options === void 0 ? void 0 : options.reduce(function (pre, cur) {\n      return _objectSpread(_objectSpread({}, pre), {}, _defineProperty({}, cur.value, cur.label));\n    }, {}) : undefined; // 如果有 label 直接就用 label\n    // @ts-ignore\n\n    if ((_rest$text = rest.text) === null || _rest$text === void 0 ? void 0 : _rest$text.label) {\n      var _rest$text2;\n\n      // @ts-ignore\n      return (_rest$text2 = rest.text) === null || _rest$text2 === void 0 ? void 0 : _rest$text2.label;\n    }\n\n    var dom = /*#__PURE__*/React.createElement(React.Fragment, null, proFieldParsingText(rest.text, ObjToMap(valueEnum || optionsValueEnum)));\n\n    if (render) {\n      return render(rest.text, _objectSpread({\n        mode: mode\n      }, fieldProps), dom) || null;\n    }\n\n    return dom;\n  }\n\n  if (mode === 'edit' || mode === 'update') {\n    var renderDom = function renderDom() {\n      if (light) {\n        return /*#__PURE__*/React.createElement(LightSelect, _extends({\n          bordered: bordered,\n          id: id,\n          loading: loading,\n          ref: inputRef,\n          allowClear: true,\n          size: size,\n          options: options,\n          label: label,\n          placeholder: intl.getMessage('tableForm.selectPlaceholder', '请选择')\n        }, fieldProps));\n      }\n\n      return /*#__PURE__*/React.createElement(SearchSelect, _extends({\n        key: \"SearchSelect\",\n        style: {\n          minWidth: 100\n        },\n        bordered: bordered,\n        id: id,\n        loading: loading,\n        ref: inputRef,\n        allowClear: true,\n        notFoundContent: loading ? /*#__PURE__*/React.createElement(_Spin, {\n          size: \"small\"\n        }) : fieldProps === null || fieldProps === void 0 ? void 0 : fieldProps.notFoundContent,\n        fetchData: function fetchData(keyWord) {\n          keyWordsRef.current = keyWord;\n\n          _fetchData(keyWord);\n        },\n        resetData: resetData,\n        optionItemRender: function optionItemRender(item) {\n          if (typeof item.label === 'string' && keyWordsRef.current) {\n            return /*#__PURE__*/React.createElement(Highlight, {\n              label: item.label,\n              words: [keyWordsRef.current]\n            });\n          }\n\n          return item.label;\n        },\n        placeholder: intl.getMessage('tableForm.selectPlaceholder', '请选择'),\n        label: label\n      }, fieldProps, {\n        options: options\n      }));\n    };\n\n    var _dom = renderDom();\n\n    if (renderFormItem) {\n      return renderFormItem(rest.text, _objectSpread(_objectSpread({\n        mode: mode\n      }, fieldProps), {}, {\n        options: options\n      }), _dom) || null;\n    }\n\n    return _dom;\n  }\n\n  return null;\n};\n\nexport default /*#__PURE__*/React.forwardRef(FieldSelect);"]},"metadata":{},"sourceType":"module"}